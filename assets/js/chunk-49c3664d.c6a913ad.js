(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49c3664d"],{3445:function(e,t,a){"use strict";var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"filtros-dinamicos"},[t("div",{staticClass:"filtros-header"},[t("h4",[t("i",{staticClass:"ti-filter"}),e._v("\n      Filtros ("+e._s(e.camposDisponibles.length)+" campos)\n    ")]),e.hasActiveFilters?t("button",{staticClass:"btn-clear-filters",on:{click:e.limpiarFiltros}},[t("i",{staticClass:"ti-close"}),e._v(" Limpiar\n    ")]):e._e()]),t("div",{staticClass:"filtros-content"},[0===e.camposDisponibles.length?t("div",{staticClass:"text-center text-muted"},[t("p",[e._v("No hay campos disponibles para filtrar")])]):t("div",{staticClass:"row"},e._l(e.camposDisponibles,(function(a){return t("div",{key:a.nombre||a,staticClass:"col-md-6 col-lg-4 mb-3"},[t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label",attrs:{for:"filtro-"+(a.nombre||a)}},[e._v("\n            "+e._s((a.nombre||a).charAt(0).toUpperCase()+(a.nombre||a).slice(1))+"\n          ")]),"texto"===a.tipo||"email"===a.tipo?t("input",{directives:[{name:"model",rawName:"v-model",value:e.filtros[a.nombre||a],expression:"filtros[campo.nombre || campo]"}],staticClass:"form-control",attrs:{id:"filtro-"+(a.nombre||a),type:"text",placeholder:"Filtrar por "+(a.nombre||a)},domProps:{value:e.filtros[a.nombre||a]},on:{input:[function(t){t.target.composing||e.$set(e.filtros,a.nombre||a,t.target.value)},e.aplicarFiltros]}}):"relacional"===a.tipo?t("select",{directives:[{name:"model",rawName:"v-model",value:e.filtros[a.nombre||a],expression:"filtros[campo.nombre || campo]"}],staticClass:"form-control",attrs:{id:"filtro-"+(a.nombre||a)},on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.filtros,a.nombre||a,t.target.multiple?o:o[0])},e.aplicarFiltros]}},[t("option",{attrs:{value:""}},[e._v("Todos")]),e._l(e.getOpcionesRelacionadas(a.seccion),(function(a){return t("option",{key:a,domProps:{value:a}},[e._v("\n              "+e._s(a)+"\n            ")])}))],2):e._e(),"relacional"===a.tipo?t("small",{staticClass:"text-muted"},[e._v("\n            Opciones: "+e._s(e.getOpcionesRelacionadas(a.seccion).length)+"\n          ")]):"fecha"===a.tipo?t("input",{directives:[{name:"model",rawName:"v-model",value:e.filtros[a.nombre||a],expression:"filtros[campo.nombre || campo]"}],staticClass:"form-control",attrs:{id:"filtro-"+(a.nombre||a),type:"date"},domProps:{value:e.filtros[a.nombre||a]},on:{change:e.aplicarFiltros,input:function(t){t.target.composing||e.$set(e.filtros,a.nombre||a,t.target.value)}}}):"numero"===a.tipo?t("input",{directives:[{name:"model",rawName:"v-model",value:e.filtros[a.nombre||a],expression:"filtros[campo.nombre || campo]"}],staticClass:"form-control",attrs:{id:"filtro-"+(a.nombre||a),type:"number",placeholder:"Filtrar por "+(a.nombre||a)},domProps:{value:e.filtros[a.nombre||a]},on:{input:[function(t){t.target.composing||e.$set(e.filtros,a.nombre||a,t.target.value)},e.aplicarFiltros]}}):e._e()])])})),0)])])},r=[],n=a("2b0e"),i={name:"FiltrosDinamicos",props:{camposDisponibles:{type:Array,default:()=>[]},secciones:{type:Array,default:()=>[]}},emits:["filtros-cambiados"],setup(e,{emit:t}){console.log("🎯 FiltrosDinamicos - Secciones recibidas:",e.secciones),console.log("🎯 FiltrosDinamicos - Campos disponibles:",e.camposDisponibles);const a=Object(n["ref"])({}),o=Object(n["computed"])(()=>Object.values(a.value).some(e=>e&&""!==e.toString().trim()));let r=null;const i=()=>{clearTimeout(r),r=setTimeout(()=>{const e={};Object.entries(a.value).forEach(([t,a])=>{a&&""!==a.toString().trim()&&(e[t]=a)}),t("filtros-cambiados",e)},300)},s=()=>{a.value={},t("filtros-cambiados",{})},l=t=>{console.log("🔍 Buscando opciones para sección:",t),console.log("📋 Secciones disponibles:",e.secciones.map(e=>e.nombre));const a=e.secciones.find(e=>(e.slug||c(e.nombre))===(t?c(t):""));if(!a)return console.log("❌ No se encontró la sección:",t),[];if(!a.columnas||0===a.columnas.length)return console.log("❌ La sección no tiene columnas:",a.nombre),[];const o=a.columnas[0].nombre;console.log("🔑 Campo clave:",o);let r=[];if(!a.datos||!Array.isArray(a.datos))return console.log("⚠️ No hay datos disponibles para la sección:",a.nombre),[];r=a.datos,console.log("✅ Datos encontrados en seccion.datos:",r.length);const n=r.map(e=>e.valores&&void 0!==e.valores[o]?e.valores[o]:void 0!==e[o]?e[o]:null).filter(Boolean),i=[...new Set(n)];return console.log("📊 Valores únicos encontrados:",i),i};function c(e){return e.toString().toLowerCase().normalize("NFD").replace(/[ \u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}return{filtros:a,hasActiveFilters:o,aplicarFiltros:i,limpiarFiltros:s,getOpcionesRelacionadas:l}}},s=i,l=(a("ed18"),a("2877")),c=Object(l["a"])(s,o,r,!1,null,"b3363d70",null);t["a"]=c.exports},"4b04":function(module,__webpack_exports__,__webpack_require__){"use strict";(function(global){__webpack_require__.d(__webpack_exports__,"a",(function(){return gapi}));var gapi=window.gapi=window.gapi||{};gapi._bs=(new Date).getTime(),function(){var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,a){return e==Array.prototype||e==Object.prototype||(e[t]=a.value),e},da=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var a=e[t];if(a&&a.Math==Math)return a}throw Error("Cannot find global object")},ea=da(this),fa=function(e,t){if(t)e:{var a=ea;e=e.split(".");for(var o=0;o<e.length-1;o++){var r=e[o];if(!(r in a))break e;a=a[r]}e=e[e.length-1],o=a[e],t=t(o),t!=o&&null!=t&&aa(a,e,{configurable:!0,writable:!0,value:t})}},ha=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}};fa("Symbol",(function(e){if(e)return e;var t=function(e,t){this.ba=e,aa(this,"description",{configurable:!0,writable:!0,value:t})};t.prototype.toString=function(){return this.ba};var a=0,o=function(e){if(this instanceof o)throw new TypeError("Symbol is not a constructor");return new t("jscomp_symbol_"+(e||"")+"_"+a++,e)};return o})),fa("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),a=0;a<t.length;a++){var o=ea[t[a]];"function"===typeof o&&"function"!=typeof o.prototype[e]&&aa(o.prototype,e,{configurable:!0,writable:!0,value:function(){return ia(ha(this))}})}return e}));var ia=function(e){return e={next:e},e[Symbol.iterator]=function(){return this},e},ja=function(e,t){e instanceof String&&(e+="");var a=0,o=!1,r={next:function(){if(!o&&a<e.length){var r=a++;return{value:t(r,e[r]),done:!1}}return o=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r};fa("Array.prototype.keys",(function(e){return e||function(){return ja(this,(function(e){return e}))}}));var m=this||self,ka=function(e){var t=typeof e;return"object"!=t?t:e?Array.isArray(e)?"array":t:"null"},la=function(e,t,a){return e.call.apply(e.bind,arguments)},ma=function(e,t,a){if(!e)throw Error();if(2<arguments.length){var o=Array.prototype.slice.call(arguments,2);return function(){var a=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(a,o),e.apply(t,a)}}return function(){return e.apply(t,arguments)}},na=function(e,t,a){return na=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?la:ma,na.apply(null,arguments)},oa=function(e,t){function a(){}a.prototype=t.prototype,e.ma=t.prototype,e.prototype=new a,e.prototype.constructor=e,e.A=function(e,a,o){for(var r=Array(arguments.length-2),n=2;n<arguments.length;n++)r[n-2]=arguments[n];return t.prototype[a].apply(e,r)}},pa=function(e){return e},qa=function(e){var t=null,a=m.trustedTypes;if(!a||!a.createPolicy)return t;try{t=a.createPolicy(e,{createHTML:pa,createScript:pa,createScriptURL:pa})}catch(o){m.console&&m.console.error(o.message)}return t};function q(e){if(Error.captureStackTrace)Error.captureStackTrace(this,q);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}oa(q,Error),q.prototype.name="CustomError";var ra=function(e,t){e=e.split("%s");for(var a="",o=e.length-1,r=0;r<o;r++)a+=e[r]+(r<t.length?t[r]:"%s");q.call(this,a+e[o])};oa(ra,q),ra.prototype.name="AssertionError";var sa=function(e,t,a,o){var r="Assertion failed";if(a){r+=": "+a;var n=o}else e&&(r+=": "+e,n=t);throw new ra(""+r,n||[])},ta=function(e,t,a){return e||sa("",null,t,Array.prototype.slice.call(arguments,2)),e},ua=function(e,t){throw new ra("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))},va=function(e,t,a){"string"!==typeof e&&sa("Expected string but got %s: %s.",[ka(e),e],t,Array.prototype.slice.call(arguments,2))},xa=function(e,t){e:{try{var a=e&&e.ownerDocument,o=a&&(a.defaultView||a.parentWindow);if(o=o||m,o.Element&&o.Location){var r=o;break e}}catch(i){}r=null}if(r&&"undefined"!=typeof r[t]&&(!e||!(e instanceof r[t])&&(e instanceof r.Location||e instanceof r.Element))){if(r=typeof e,"object"==r&&null!=e||"function"==r)try{var n=e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e)}catch(i){n="<object could not be stringified>"}else n=void 0===e?"undefined":null===e?"null":typeof e;ua("Argument is not a %s (or a non-Element, non-Location mock); got: %s",t,n)}return e},ya,t=function(e,t){this.P=e===za&&t||"",this.ca=Aa};t.prototype.J=!0,t.prototype.H=function(){return this.P},t.prototype.toString=function(){return"Const{"+this.P+"}"};var Ba=function(e){return e instanceof t&&e.constructor===t&&e.ca===Aa?e.P:(ua("expected object of type Const, got '"+e+"'"),"type_error:Const")},Aa={},za={},v=function(e,t){this.N=t===Ca?e:""};v.prototype.J=!0,v.prototype.H=function(){return this.N.toString()},v.prototype.toString=function(){return"SafeUrl{"+this.N+"}"};var Da=function(e){return e instanceof v&&e.constructor===v?e.N:(ua("expected object of type SafeUrl, got '"+e+"' of type "+ka(e)),"type_error:SafeUrl")},Ea=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i,Fa=function(e){return e instanceof v?e:(e="object"==typeof e&&e.J?e.H():String(e),ta(Ea.test(e),"%s does not match the safe URL pattern",e)||(e="about:invalid#zClosurez"),new v(e,Ca))},Ca={},w=function(e,t,a){this.M=a===Ga?e:""};w.prototype.J=!0,w.prototype.H=function(){return this.M.toString()},w.prototype.toString=function(){return"SafeHtml{"+this.M+"}"};var Ha=function(e){return e instanceof w&&e.constructor===w?e.M:(ua("expected object of type SafeHtml, got '"+e+"' of type "+ka(e)),"type_error:SafeHtml")},Ga={},Ia=new w(m.trustedTypes&&m.trustedTypes.emptyHTML||"",0,Ga),Ja={MATH:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0},Ka=function(e){var t,a=!1;return function(){return a||(t=e(),a=!0),t}}((function(){if("undefined"===typeof document)return!1;var e=document.createElement("div"),t=document.createElement("div");return t.appendChild(document.createElement("div")),e.appendChild(t),!!e.firstChild&&(t=e.firstChild.firstChild,e.innerHTML=Ha(Ia),!t.parentElement)})),x=window,z=document,La=x.location,Ma=function(){},Na=/\[native code\]/,A=function(e,t,a){return e[t]=e[t]||a},Oa=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1},Pa=function(e){e=e.sort();for(var t=[],a=void 0,o=0;o<e.length;o++){var r=e[o];r!=a&&t.push(r),a=r}return t},Qa=/&/g,Ra=/</g,Sa=/>/g,Ua=/"/g,Va=/'/g,Wa=function(e){return String(e).replace(Qa,"&amp;").replace(Ra,"&lt;").replace(Sa,"&gt;").replace(Ua,"&quot;").replace(Va,"&#39;")},B=function(){var e;if((e=Object.create)&&Na.test(e))e=e(null);else for(var t in e={},e)e[t]=void 0;return e},C=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Xa=function(e){if(Na.test(Object.keys))return Object.keys(e);var t,a=[];for(t in e)C(e,t)&&a.push(t);return a},D=function(e,t){for(var a in e=e||{},e)C(e,a)&&(t[a]=e[a])},Ya=function(e){return function(){x.setTimeout(e,0)}},E=function(e,t){if(!e)throw Error(t||"")},F=A(x,"gapi",{}),H=function(e,t,a){var o=new RegExp("([#].*&|[#])"+t+"=([^&#]*)","g");if(t=new RegExp("([?#].*&|[?#])"+t+"=([^&#]*)","g"),e=e&&(o.exec(e)||t.exec(e)))try{a=decodeURIComponent(e[2])}catch(r){}return a},Za=new RegExp(/^/.source+/([a-zA-Z][-+.a-zA-Z0-9]*:)?/.source+/(\/\/[^\/?#]*)?/.source+/([^?#]*)?/.source+/(\?([^#]*))?/.source+/(#((#|[^#])*))?/.source+/$/.source),$a=/[\ud800-\udbff][\udc00-\udfff]|[^!-~]/g,ab=new RegExp(/(%([^0-9a-fA-F%]|[0-9a-fA-F]([^0-9a-fA-F%])?)?)*/.source+/%($|[^0-9a-fA-F]|[0-9a-fA-F]($|[^0-9a-fA-F]))/.source,"g"),bb=/%([a-f]|[0-9a-fA-F][a-f])/g,cb=/^(https?|ftp|file|chrome-extension):$/i,I=function(e){e=String(e),e=e.replace($a,(function(e){try{return encodeURIComponent(e)}catch(t){return encodeURIComponent(e.replace(/^[^%]+$/g,"�"))}})).replace(ab,(function(e){return e.replace(/%/g,"%25")})).replace(bb,(function(e){return e.toUpperCase()})),e=e.match(Za)||[];var t=B(),a=function(e){return e.replace(/\\/g,"%5C").replace(/\^/g,"%5E").replace(/`/g,"%60").replace(/\{/g,"%7B").replace(/\|/g,"%7C").replace(/\}/g,"%7D")},o=!!(e[1]||"").match(cb);return t.A=a((e[1]||"")+(e[2]||"")+(e[3]||(e[2]&&o?"/":""))),o=function(e){return a(e.replace(/\?/g,"%3F").replace(/#/g,"%23"))},t.query=e[5]?[o(e[5])]:[],t.g=e[7]?[o(e[7])]:[],t},db=function(e){return e.A+(0<e.query.length?"?"+e.query.join("&"):"")+(0<e.g.length?"#"+e.g.join("&"):"")},eb=function(e,t){var a=[];if(e)for(var o in e)if(C(e,o)&&null!=e[o]){var r=t?t(e[o]):e[o];a.push(encodeURIComponent(o)+"="+encodeURIComponent(r))}return a},fb=function(e,t,a,o){return e=I(e),e.query.push.apply(e.query,eb(t,o)),e.g.push.apply(e.g,eb(a,o)),db(e)},gb=new RegExp(/\/?\??#?/.source+"("+/[\/?#]/i.source+"|"+/[\uD800-\uDBFF]/i.source+"|"+/%[c-f][0-9a-f](%[89ab][0-9a-f]){0,2}(%[89ab]?)?/i.source+"|"+/%[0-9a-f]?/i.source+")$","i"),hb=function(e,a){var o=I(a);a=o.A,o.query.length&&(a+="?"+o.query.join("")),o.g.length&&(a+="#"+o.g.join(""));var r="";2e3<a.length&&(r=a,a=a.substr(0,2e3),a=a.replace(gb,""),r=r.substr(a.length));var n=e.createElement("div");if(e=e.createElement("a"),o=I(a),a=o.A,o.query.length&&(a+="?"+o.query.join("")),o.g.length&&(a+="#"+o.g.join("")),a=new v(a,Ca),xa(e,"HTMLAnchorElement"),a=a instanceof v?a:Fa(a),e.href=Da(a),n.appendChild(e),a=n.innerHTML,o=new t(za,"Assignment to self."),va(Ba(o),"must provide justification"),ta(!/^[\s\xa0]*$/.test(Ba(o)),"must provide non-empty justification"),void 0===ya&&(ya=qa("gapi#html")),a=(o=ya)?o.createHTML(a):a,a=new w(a,null,Ga),n.tagName&&Ja[n.tagName.toUpperCase()])throw Error("goog.dom.safe.setInnerHtml cannot be used to set content of "+n.tagName+".");if(Ka())for(;n.lastChild;)n.removeChild(n.lastChild);return n.innerHTML=Ha(a),a=String(n.firstChild.href),n.parentNode&&n.parentNode.removeChild(n),o=I(a+r),r=o.A,o.query.length&&(r+="?"+o.query.join("")),o.g.length&&(r+="#"+o.g.join("")),r},ib=/^https?:\/\/[^\/%\\?#\s]+\/[^\s]*$/i,jb=function(e,t,a,o){x[a+"EventListener"]?x[a+"EventListener"](e,t,!1):x[o+"tachEvent"]&&x[o+"tachEvent"]("on"+e,t)},kb=function(){var e=z.readyState;return"complete"===e||"interactive"===e&&-1==navigator.userAgent.indexOf("MSIE")},nb=function(e){var t=lb;if(!kb())try{t()}catch(a){}mb(e)},mb=function(e){if(kb())e();else{var t=!1,a=function(){if(!t)return t=!0,e.apply(this,arguments)};x.addEventListener?(x.addEventListener("load",a,!1),x.addEventListener("DOMContentLoaded",a,!1)):x.attachEvent&&(x.attachEvent("onreadystatechange",(function(){kb()&&a.apply(this,arguments)})),x.attachEvent("onload",a))}},ob=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},pb={button:!0,div:!0,span:!0},K;K=A(x,"___jsl",B()),A(K,"I",0),A(K,"hel",10);var qb=function(e){return K.dpo?K.h:H(e,"jsh",K.h)},rb=function(e){var t=A(K,"sws",[]);t.push.apply(t,e)},sb=function(e){return A(K,"watt",B())[e]},tb=function(e){var t=A(K,"PQ",[]);K.PQ=[];var a=t.length;if(0===a)e();else for(var o=0,r=function(){++o===a&&e()},n=0;n<a;n++)t[n](r)},ub=function(e){return A(A(K,"H",B()),e,B())},vb=A(K,"perf",B()),wb=A(vb,"g",B()),xb=A(vb,"i",B());A(vb,"r",[]),B(),B();var yb=function(e,t,a){var o=vb.r;"function"===typeof o?o(e,t,a):o.push([e,t,a])},L=function(e,t,a){wb[e]=!t&&wb[e]||a||(new Date).getTime(),yb(e)},Ab=function(e,t,a){t&&0<t.length&&(t=zb(t),a&&0<a.length&&(t+="___"+zb(a)),28<t.length&&(t=t.substr(0,28)+(t.length-28)),a=t,t=A(xb,"_p",B()),A(t,a,B())[e]=(new Date).getTime(),yb(e,"_p",a))},zb=function(e){return e.join("__").replace(/\./g,"_").replace(/\-/g,"_").replace(/,/g,"_")},Bb=B(),N=[],O=function(e){throw Error("Bad hint"+(e?": "+e:""))};N.push(["jsl",function(e){for(var t in e)if(C(e,t)){var a=e[t];"object"==typeof a?K[t]=A(K,t,[]).concat(a):A(K,t,a)}(t=e.u)&&(e=A(K,"us",[]),e.push(t),(t=/^https:(.*)$/.exec(t))&&e.push("http:"+t[1]))}]);var Cb=/^(\/[a-zA-Z0-9_\-]+)+$/,Db=[/\/amp\//,/\/amp$/,/^\/amp$/],Eb=/^[a-zA-Z0-9\-_\.,!]+$/,Fb=/^gapi\.loaded_[0-9]+$/,Gb=/^[a-zA-Z0-9,._-]+$/,Kb=function(e,t,a,o){var r=e.split(";"),n=r.shift(),i=Bb[n],s=null;return i?s=i(r,t,a,o):O("no hint processor for: "+n),s||O("failed to generate load url"),t=s,a=t.match(Hb),(o=t.match(Ib))&&1===o.length&&Jb.test(t)&&a&&1===a.length||O("failed sanity: "+e),s},Nb=function(e,t,a,o){e=Lb(e),Fb.test(a)||O("invalid_callback"),t=Mb(t),o=o&&o.length?Mb(o):null;var r=function(e){return encodeURIComponent(e).replace(/%2C/g,",")};return[encodeURIComponent(e.pathPrefix).replace(/%2C/g,",").replace(/%2F/g,"/"),"/k=",r(e.version),"/m=",r(t),o?"/exm="+r(o):"","/rt=j/sv=1/d=1/ed=1",e.S?"/am="+r(e.S):"",e.Z?"/rs="+r(e.Z):"",e.aa?"/t="+r(e.aa):"","/cb=",r(a)].join("")},Lb=function(e){"/"!==e.charAt(0)&&O("relative path");for(var t=e.substring(1).split("/"),a=[];t.length;){if(e=t.shift(),e.length&&0!=e.indexOf(".")){if(0<e.indexOf("=")){t.unshift(e);break}}else O("empty/relative directory");a.push(e)}e={};for(var o=0,r=t.length;o<r;++o){var n=t[o].split("="),i=decodeURIComponent(n[0]),s=decodeURIComponent(n[1]);2==n.length&&i&&s&&(e[i]=e[i]||s)}for(t="/"+a.join("/"),Cb.test(t)||O("invalid_prefix"),a=0,o=Db.length;a<o;++a)Db[a].test(t)&&O("invalid_prefix");return a=Ob(e,"k",!0),o=Ob(e,"am"),r=Ob(e,"rs"),e=Ob(e,"t"),{pathPrefix:t,version:a,S:o,Z:r,aa:e}},Mb=function(e){for(var t=[],a=0,o=e.length;a<o;++a){var r=e[a].replace(/\./g,"_").replace(/-/g,"_");Gb.test(r)&&t.push(r)}return t.join(",")},Ob=function(e,t,a){if(e=e[t],!e&&a&&O("missing: "+t),e){if(Eb.test(e))return e;O("invalid: "+t)}return null},Jb=/^https?:\/\/[a-z0-9_.-]+\.google(rs)?\.com(:\d+)?\/[a-zA-Z0-9_.,!=\-\/]+$/,Ib=/\/cb=/g,Hb=/\/\//g,Pb=function(){var e=qb(La.href);if(!e)throw Error("Bad hint");return e};Bb.m=function(e,t,a,o){return(e=e[0])||O("missing_hint"),"https://apis.google.com"+Nb(e,t,a,o)};var Qb=decodeURI("%73cript"),Rb=/^[-+_0-9\/A-Za-z]+={0,2}$/,Sb=function(e,t){for(var a=[],o=0;o<e.length;++o){var r=e[o];r&&0>Oa.call(t,r)&&a.push(r)}return a},Tb=function(){var e=K.nonce;return void 0!==e?e&&e===String(e)&&e.match(Rb)?e:K.nonce=null:z.querySelector&&(e=z.querySelector("script[nonce]"))?(e=e.nonce||e.getAttribute("nonce")||"",e&&e===String(e)&&e.match(Rb)?K.nonce=e:K.nonce=null):null},Wb=function(e){if("loading"!=z.readyState)Ub(e);else{var t=Tb(),a="";null!==t&&(a=' nonce="'+t+'"'),e="<"+Qb+' src="'+encodeURI(e)+'"'+a+"></"+Qb+">",z.write(Vb?Vb.createHTML(e):e)}},Ub=function(e){var t=z.createElement(Qb);t.setAttribute("src",Vb?Vb.createScriptURL(e):e),e=Tb(),null!==e&&t.setAttribute("nonce",e),t.async="true",(e=z.getElementsByTagName(Qb)[0])?e.parentNode.insertBefore(t,e):(z.head||z.body||z.documentElement).appendChild(t)},Xb=function(e,t){var a=t&&t._c;if(a)for(var o=0;o<N.length;o++){var r=N[o][0],n=N[o][1];n&&C(a,r)&&n(a[r],e,t)}},Zb=function(e,t,a){Yb((function(){var a=t===qb(La.href)?A(F,"_",B()):B();a=A(ub(t),"_",a),e(a)}),a)},ac=function(e,t){var a=t||{};"function"==typeof t&&(a={},a.callback=t),Xb(e,a),t=e?e.split(":"):[];var o=a.h||Pb(),r=A(K,"ah",B());if(r["::"]&&t.length){e=[];for(var n=null;n=t.shift();){var i=n.split(".");i=r[n]||r[i[1]&&"ns:"+i[0]||""]||o;var s=e.length&&e[e.length-1]||null,l=s;s&&s.hint==i||(l={hint:i,V:[]},e.push(l)),l.V.push(n)}var c=e.length;if(1<c){var u=a.callback;u&&(a.callback=function(){0==--c&&u()})}for(;t=e.shift();)$b(t.V,a,t.hint)}else $b(t||[],a,o)},$b=function(e,t,a){e=Pa(e)||[];var o=t.callback,r=t.config,n=t.timeout,i=t.ontimeout,s=t.onerror,l=void 0;"function"==typeof s&&(l=s);var c=null,u=!1;if(n&&!i||!n&&i)throw"Timeout requires both the timeout parameter and ontimeout parameter to be set";s=A(ub(a),"r",[]).sort();var d=A(ub(a),"L",[]).sort(),p=[].concat(s),v=function(e,t){if(u)return 0;x.clearTimeout(c),d.push.apply(d,m);var o=((F||{}).config||{}).update;if(o?o(r):r&&A(K,"cu",[]).push(r),t){Ab("me0",e,p);try{Zb(t,a,l)}finally{Ab("me1",e,p)}}return 1};0<n&&(c=x.setTimeout((function(){u=!0,i()}),n));var m=Sb(e,d);if(m.length){m=Sb(e,s);var g=A(K,"CP",[]),f=g.length;if(g[f]=function(e){if(!e)return 0;Ab("ml1",m,p);var t=function(t){g[f]=null,v(m,e)&&tb((function(){o&&o(),t()}))},a=function(){var e=g[f+1];e&&e()};0<f&&g[f-1]?g[f]=function(){t(a)}:t(a)},m.length){var b="loaded_"+K.I++;F[b]=function(e){g[f](e),F[b]=null},e=Kb(a,m,"gapi."+b,s),s.push.apply(s,m),Ab("ml0",m,p),t.sync||x.___gapisync?Wb(e):Ub(e)}else g[f](Ma)}else v(m)&&o&&o()},Vb=qa("gapi#gapi"),Yb=function(e,t){if(K.hee&&0<K.hel)try{return e()}catch(a){t&&t(a),K.hel--,ac("debug_error",(function(){try{window.___jsl.hefn(a)}catch(e){throw a}}))}else try{return e()}catch(a){throw t&&t(a),a}};F.load=function(e,t){return Yb((function(){return ac(e,t)}))};var bc=function(e){var t=window.___jsl=window.___jsl||{};return t[e]=t[e]||[],t[e]},cc=function(e){var t=window.___jsl=window.___jsl||{};return t.cfg=!e&&t.cfg||{},t.cfg},dc=function(e){return"object"===typeof e&&/\[native code\]/.test(e.push)},P=function(e,t,a){if(t&&"object"===typeof t)for(var o in t)!Object.prototype.hasOwnProperty.call(t,o)||a&&"___goc"===o&&"undefined"===typeof t[o]||(e[o]&&t[o]&&"object"===typeof e[o]&&"object"===typeof t[o]&&!dc(e[o])&&!dc(t[o])?P(e[o],t[o]):t[o]&&"object"===typeof t[o]?(e[o]=dc(t[o])?[]:{},P(e[o],t[o])):e[o]=t[o])},ec=function(e){if(e&&!/^\s+$/.test(e)){for(;0==e.charCodeAt(e.length-1);)e=e.substring(0,e.length-1);try{var t=window.JSON.parse(e)}catch(a){}if("object"===typeof t)return t;try{t=new Function("return ("+e+"\n)")()}catch(a){}if("object"===typeof t)return t;try{t=new Function("return ({"+e+"\n})")()}catch(a){}return"object"===typeof t?t:{}}},fc=function(e,t){var a={___goc:void 0};e.length&&e[e.length-1]&&Object.hasOwnProperty.call(e[e.length-1],"___goc")&&"undefined"===typeof e[e.length-1].___goc&&(a=e.pop()),P(a,t),e.push(a)},gc=function(e){cc(!0);var t=window.___gcfg,a=bc("cu"),o=window.___gu;t&&t!==o&&(fc(a,t),window.___gu=t),t=bc("cu");var r=document.scripts||document.getElementsByTagName("script")||[];o=[];var n=[];n.push.apply(n,bc("us"));for(var i=0;i<r.length;++i)for(var s=r[i],l=0;l<n.length;++l)s.src&&0==s.src.indexOf(n[l])&&o.push(s);for(0==o.length&&0<r.length&&r[r.length-1].src&&o.push(r[r.length-1]),r=0;r<o.length;++r)o[r].getAttribute("gapi_processed")||(o[r].setAttribute("gapi_processed",!0),(n=o[r])?(i=n.nodeType,n=3==i||4==i?n.nodeValue:n.textContent||n.innerText||n.innerHTML||""):n=void 0,(n=ec(n))&&t.push(n));for(e&&fc(a,e),o=bc("cd"),e=0,t=o.length;e<t;++e)P(cc(),o[e],!0);for(o=bc("ci"),e=0,t=o.length;e<t;++e)P(cc(),o[e],!0);for(e=0,t=a.length;e<t;++e)P(cc(),a[e],!0)},Q=function(e){var t=cc();if(!e)return t;e=e.split("/");for(var a=0,o=e.length;t&&"object"===typeof t&&a<o;++a)t=t[e[a]];return a===e.length&&void 0!==t?t:void 0},hc=function(e,t){var a;if("string"===typeof e){var o=a={};e=e.split("/");for(var r=0,n=e.length;r<n-1;++r){var i={};o=o[e[r]]=i}o[e[r]]=t}else a=e;gc(a)},ic=function(){var e=window.__GOOGLEAPIS;e&&(e.googleapis&&!e["googleapis.config"]&&(e["googleapis.config"]=e.googleapis),A(K,"ci",[]).push(e),window.__GOOGLEAPIS=void 0)},jc={callback:1,clientid:1,cookiepolicy:1,openidrealm:-1,includegrantedscopes:-1,requestvisibleactions:1,scope:1},kc=!1,lc=B(),mc=function(){if(!kc){for(var e=document.getElementsByTagName("meta"),t=0;t<e.length;++t){var a=e[t].name.toLowerCase();if(0==a.lastIndexOf("google-signin-",0)){a=a.substring(14);var o=e[t].content;jc[a]&&o&&(lc[a]=o)}}if(window.self!==window.top)for(var r in e=document.location.toString(),jc)0<jc[r]&&(t=H(e,r,""))&&(lc[r]=t);kc=!0}return r=B(),D(lc,r),r},nc=function(e){return!!(e.clientid&&e.scope&&e.callback)},oc=window.console,pc=function(e){oc&&oc.log&&oc.log(e)},qc=function(){return!!K.oa},rc=function(){},R=A(K,"rw",B()),sc=function(e){for(var t in R)e(R[t])},tc=function(e,t){(e=R[e])&&e.state<t&&(e.state=t)},uc,vc=/^https?:\/\/(?:\w|[\-\.])+\.google\.(?:\w|[\-:\.])+(?:\/[^\?#]*)?\/u\/(\d)\//,wc=/^https?:\/\/(?:\w|[\-\.])+\.google\.(?:\w|[\-:\.])+(?:\/[^\?#]*)?\/b\/(\d{10,21})\//,xc=function(e){var t=Q("googleapis.config/sessionIndex");if("string"===typeof t&&254<t.length&&(t=null),null==t&&(t=window.__X_GOOG_AUTHUSER),"string"===typeof t&&254<t.length&&(t=null),null==t){var a=window.google;a&&(t=a.authuser)}return"string"===typeof t&&254<t.length&&(t=null),null==t&&(e=e||window.location.href,t=H(e,"authuser")||null,null==t&&(t=(t=e.match(vc))?t[1]:null)),null==t?null:(t=String(t),254<t.length&&(t=null),t)},yc=function(e){var t=Q("googleapis.config/sessionDelegate");return"string"===typeof t&&21<t.length&&(t=null),null==t&&(t=(e=(e||window.location.href).match(wc))?e[1]:null),null==t?null:(t=String(t),21<t.length&&(t=null),t)},zc,S,T=void 0,U=function(e){try{return m.JSON.parse.call(m.JSON,e)}catch(t){return!1}},V=function(e){return Object.prototype.toString.call(e)},Ac=V(0),Bc=V(new Date(0)),Cc=V(!0),Dc=V(""),Ec=V({}),Fc=V([]),W=function(e,t){if(t)for(var a=0,o=t.length;a<o;++a)if(e===t[a])throw new TypeError("Converting circular structure to JSON");if(o=typeof e,"undefined"!==o){a=Array.prototype.slice.call(t||[],0),a[a.length]=e,t=[];var r=V(e);if(null!=e&&"function"===typeof e.toJSON&&(Object.prototype.hasOwnProperty.call(e,"toJSON")||(r!==Fc||e.constructor!==Array&&e.constructor!==Object)&&(r!==Ec||e.constructor!==Array&&e.constructor!==Object)&&r!==Dc&&r!==Ac&&r!==Cc&&r!==Bc))return W(e.toJSON.call(e),a);if(null==e)t[t.length]="null";else if(r===Ac)e=Number(e),isNaN(e)||isNaN(e-e)?e="null":-0===e&&0>1/e&&(e="-0"),t[t.length]=String(e);else if(r===Cc)t[t.length]=String(!!Number(e));else{if(r===Bc)return W(e.toISOString.call(e),a);if(r===Fc&&V(e.length)===Ac){t[t.length]="[";var n=0;for(o=Number(e.length)>>0;n<o;++n)n&&(t[t.length]=","),t[t.length]=W(e[n],a)||"null";t[t.length]="]"}else if(r==Dc&&V(e.length)===Ac){for(t[t.length]='"',n=0,a=Number(e.length)>>0;n<a;++n)o=String.prototype.charAt.call(e,n),r=String.prototype.charCodeAt.call(e,n),t[t.length]="\b"===o?"\\b":"\f"===o?"\\f":"\n"===o?"\\n":"\r"===o?"\\r":"\t"===o?"\\t":"\\"===o||'"'===o?"\\"+o:31>=r?"\\u"+(r+65536).toString(16).substr(1):32<=r&&65535>=r?o:"�";t[t.length]='"'}else{if("object"!==o)return;for(n in t[t.length]="{",o=0,e)Object.prototype.hasOwnProperty.call(e,n)&&(r=W(e[n],a),void 0!==r&&(o++&&(t[t.length]=","),t[t.length]=W(n),t[t.length]=":",t[t.length]=r));t[t.length]="}"}}return t.join("")}},Gc=/[\0-\x07\x0b\x0e-\x1f]/,Hc=/^([^"]*"([^\\"]|\\.)*")*[^"]*"([^"\\]|\\.)*[\0-\x1f]/,Ic=/^([^"]*"([^\\"]|\\.)*")*[^"]*"([^"\\]|\\.)*\\[^\\\/"bfnrtu]/,Jc=/^([^"]*"([^\\"]|\\.)*")*[^"]*"([^"\\]|\\.)*\\u([0-9a-fA-F]{0,3}[^0-9a-fA-F])/,Kc=/"([^\0-\x1f\\"]|\\[\\\/"bfnrt]|\\u[0-9a-fA-F]{4})*"/g,Lc=/-?(0|[1-9][0-9]*)(\.[0-9]+)?([eE][-+]?[0-9]+)?/g,Mc=/[ \t\n\r]+/g,Nc=/[^"]:/,Oc=/""/g,Pc=/true|false|null/g,Qc=/00/,Rc=/[\{]([^0\}]|0[^:])/,Sc=/(^|\[)[,:]|[,:](\]|\}|[,:]|$)/,Tc=/[^\[,:][\[\{]/,Uc=/^(\{|\}|\[|\]|,|:|0)+/,Vc=/\u2028/g,Wc=/\u2029/g,Xc=function(a){if(a=String(a),Gc.test(a)||Hc.test(a)||Ic.test(a)||Jc.test(a))return!1;var b=a.replace(Kc,'""');if(b=b.replace(Lc,"0"),b=b.replace(Mc,""),Nc.test(b))return!1;if(b=b.replace(Oc,"0"),b=b.replace(Pc,"0"),Qc.test(b)||Rc.test(b)||Sc.test(b)||Tc.test(b)||!b||(b=b.replace(Uc,"")))return!1;a=a.replace(Vc,"\\u2028").replace(Wc,"\\u2029"),b=void 0;try{b=T?[U(a)]:eval("(function (var_args) {\n  return Array.prototype.slice.call(arguments, 0);\n})(\n"+a+"\n)")}catch(c){return!1}return!(!b||1!==b.length)&&b[0]},Yc=function(){var e=((m.document||{}).scripts||[]).length;if((void 0===zc||void 0===T||S!==e)&&-1!==S){zc=T=!1,S=-1;try{try{T=!!m.JSON&&'{"a":[3,true,"1970-01-01T00:00:00.000Z"]}'===m.JSON.stringify.call(m.JSON,{a:[3,!0,new Date(0)],c:function(){}})&&!0===U("true")&&3===U('[{"a":3}]')[0].a}catch(t){}zc=T&&!U("[00]")&&!U('""')&&!U('"\\0"')&&!U('"\\v"')}finally{S=e}}},Zc=function(e){return-1!==S&&(Yc(),(zc?U:Xc)(e))},$c=function(e){if(-1!==S)return Yc(),T?m.JSON.stringify.call(m.JSON,e):W(e)},ad=!Date.prototype.toISOString||"function"!==typeof Date.prototype.toISOString||"1970-01-01T00:00:00.000Z"!==new Date(0).toISOString(),bd=function(){var e=Date.prototype.getUTCFullYear.call(this);return[0>e?"-"+String(1e6-e).substr(1):9999>=e?String(1e4+e).substr(1):"+"+String(1e6+e).substr(1),"-",String(101+Date.prototype.getUTCMonth.call(this)).substr(1),"-",String(100+Date.prototype.getUTCDate.call(this)).substr(1),"T",String(100+Date.prototype.getUTCHours.call(this)).substr(1),":",String(100+Date.prototype.getUTCMinutes.call(this)).substr(1),":",String(100+Date.prototype.getUTCSeconds.call(this)).substr(1),".",String(1e3+Date.prototype.getUTCMilliseconds.call(this)).substr(1),"Z"].join("")};Date.prototype.toISOString=ad?bd:Date.prototype.toISOString;var cd=function(){this.j=-1},dd=function(){this.j=64,this.b=[],this.G=[],this.da=[],this.C=[],this.C[0]=128;for(var e=1;e<this.j;++e)this.C[e]=0;this.D=this.o=0,this.reset()};oa(dd,cd),dd.prototype.reset=function(){this.b[0]=1732584193,this.b[1]=4023233417,this.b[2]=2562383102,this.b[3]=271733878,this.b[4]=3285377520,this.D=this.o=0};var ed=function(e,t,a){a||(a=0);var o=e.da;if("string"===typeof t)for(var r=0;16>r;r++)o[r]=t.charCodeAt(a)<<24|t.charCodeAt(a+1)<<16|t.charCodeAt(a+2)<<8|t.charCodeAt(a+3),a+=4;else for(r=0;16>r;r++)o[r]=t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3],a+=4;for(r=16;80>r;r++){var n=o[r-3]^o[r-8]^o[r-14]^o[r-16];o[r]=4294967295&(n<<1|n>>>31)}t=e.b[0],a=e.b[1];var i=e.b[2],s=e.b[3],l=e.b[4];for(r=0;80>r;r++){if(40>r)if(20>r){n=s^a&(i^s);var c=1518500249}else n=a^i^s,c=1859775393;else 60>r?(n=a&i|s&(a|i),c=2400959708):(n=a^i^s,c=3395469782);n=(t<<5|t>>>27)+n+l+c+o[r]&4294967295,l=s,s=i,i=4294967295&(a<<30|a>>>2),a=t,t=n}e.b[0]=e.b[0]+t&4294967295,e.b[1]=e.b[1]+a&4294967295,e.b[2]=e.b[2]+i&4294967295,e.b[3]=e.b[3]+s&4294967295,e.b[4]=e.b[4]+l&4294967295};dd.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var a=t-this.j,o=0,r=this.G,n=this.o;o<t;){if(0==n)for(;o<=a;)ed(this,e,o),o+=this.j;if("string"===typeof e){for(;o<t;)if(r[n]=e.charCodeAt(o),++n,++o,n==this.j){ed(this,r),n=0;break}}else for(;o<t;)if(r[n]=e[o],++n,++o,n==this.j){ed(this,r),n=0;break}}this.o=n,this.D+=t}},dd.prototype.digest=function(){var e=[],t=8*this.D;56>this.o?this.update(this.C,56-this.o):this.update(this.C,this.j-(this.o-56));for(var a=this.j-1;56<=a;a--)this.G[a]=255&t,t/=256;for(ed(this,this.G),a=t=0;5>a;a++)for(var o=24;0<=o;o-=8)e[t]=this.b[a]>>o&255,++t;return e};var fd=function(){this.O=new dd};fd.prototype.reset=function(){this.O.reset()};var gd=x.crypto,hd=!1,id=0,jd=0,kd=1,ld=0,md="",nd=function(e){e=e||x.event;var t=e.screenX+e.clientX<<16;t+=e.screenY+e.clientY,t*=(new Date).getTime()%1e6,kd=kd*t%ld,0<id&&++jd==id&&jb("mousemove",nd,"remove","de")},od=function(e){var t=new fd;e=unescape(encodeURIComponent(e));for(var a=[],o=0,r=e.length;o<r;++o)a.push(e.charCodeAt(o));for(t.O.update(a),t=t.O.digest(),e="",a=0;a<t.length;a++)e+="0123456789ABCDEF".charAt(Math.floor(t[a]/16))+"0123456789ABCDEF".charAt(t[a]%16);return e};hd=!!gd&&"function"==typeof gd.getRandomValues,hd||(ld=1e6*(screen.width*screen.width+screen.height),md=od(z.cookie+"|"+z.location+"|"+(new Date).getTime()+"|"+Math.random()),id=Q("random/maxObserveMousemove")||0,0!=id&&jb("mousemove",nd,"add","at"));var pd=function(){var e=kd;return e+=parseInt(md.substr(0,20),16),md=od(md),e/(ld+Math.pow(16,20))},qd=function(){var e=new x.Uint32Array(1);return gd.getRandomValues(e),Number("0."+e[0])},rd=function(){var e=K.onl;if(!e){e=B(),K.onl=e;var t=B();e.e=function(e){var a=t[e];a&&(delete t[e],a())},e.a=function(e,a){t[e]=a},e.r=function(e){delete t[e]}}return e},sd=function(e,t){return t=t.onload,"function"===typeof t?(rd().a(e,t),t):null},td=function(e){return E(/^\w+$/.test(e),"Unsupported id - "+e),rd(),'onload="window.___jsl.onl.e(&#34;'+e+'&#34;)"'},ud=function(e){rd().r(e)},vd={allowtransparency:"true",frameborder:"0",hspace:"0",marginheight:"0",marginwidth:"0",scrolling:"no",style:"",tabindex:"0",vspace:"0",width:"100%"},wd={allowtransparency:!0,onload:!0},xd=0,yd=function(e){E(!e||ib.test(e),"Illegal url for new iframe - "+e)},zd=function(e,t,a,o,r){yd(a.src);var n,i=sd(o,a),s=i?td(o):"";try{document.all&&(n=e.createElement('<iframe frameborder="'+Wa(String(a.frameborder))+'" scrolling="'+Wa(String(a.scrolling))+'" '+s+' name="'+Wa(String(a.name))+'"/>'))}catch(c){}finally{n||(n=e.createElement("iframe"),i&&(n.onload=function(){n.onload=null,i.call(this)},ud(o)))}for(var l in n.setAttribute("ng-non-bindable",""),a)e=a[l],"style"===l&&"object"===typeof e?D(e,n.style):wd[l]||n.setAttribute(l,String(e));return(l=r&&r.beforeNode||null)||r&&r.dontclear||ob(t),t.insertBefore(n,l),n=l?l.previousSibling:t.lastChild,a.allowtransparency&&(n.allowTransparency=!0),n},Ad=/^:[\w]+$/,Bd=/:([a-zA-Z_]+):/g,Cd=function(){var e=xc()||"0",t=yc(),a=xc(void 0)||e,o=yc(void 0),r="";a&&(r+="u/"+encodeURIComponent(String(a))+"/"),o&&(r+="b/"+encodeURIComponent(String(o))+"/"),a=r||null,(r=(o=!1===Q("isLoggedIn"))?"_/im/":"")&&(a="");var n=Q("iframes/:socialhost:"),i=Q("iframes/:im_socialhost:");return uc={socialhost:n,ctx_socialhost:o?i:n,session_index:e,session_delegate:t,session_prefix:a,im_prefix:r}},Dd=function(e,t){return Cd()[t]||""},Ed=function(e){return function(t,a){return e?Cd()[a]||e[a]||"":Cd()[a]||""}},Fd=function(e){var t;return e.match(/^https?%3A/i)&&(t=decodeURIComponent(e)),hb(document,t||e)},Gd=function(e){e=e||"canonical";for(var t=document.getElementsByTagName("link"),a=0,o=t.length;a<o;a++){var r=t[a],n=r.getAttribute("rel");if(n&&n.toLowerCase()==e&&(r=r.getAttribute("href"))&&(r=Fd(r))&&null!=r.match(/^https?:\/\/[\w\-_\.]+/i))return r}return window.location.href},Hd={se:"0"},Id={post:!0},Jd={style:"position:absolute;top:-10000px;width:450px;margin:0px;border-style:none"},Kd="onPlusOne _ready _close _open _resizeMe _renderstart oncircled drefresh erefresh".split(" "),Ld=A(K,"WI",B()),Md=function(e,t,a){var o,r={},n=o=e;for(var i in"plus"==e&&t.action&&(o=e+"_"+t.action,n=e+"/"+t.action),(o=Q("iframes/"+o+"/url"))||(o=":im_socialhost:/:session_prefix::im_prefix:_/widget/render/"+n+"?usegapi=1"),Hd)r[i]=i+"/"+(t[i]||Hd[i])+"/";if(r=hb(z,o.replace(Bd,Ed(r))),i="iframes/"+e+"/params/",n={},D(t,n),(o=Q("lang")||Q("gwidget/lang"))&&(n.hl=o),Id[e]||(n.origin=window.location.origin||window.location.protocol+"//"+window.location.host),n.exp=Q(i+"exp"),i=Q(i+"location"))for(o=0;o<i.length;o++){var s=i[o];n[s]=x.location[s]}switch(e){case"plus":case"follow":i=n.href,o=t.action?void 0:"publisher",i=(i="string"==typeof i?i:void 0)?Fd(i):Gd(o),n.url=i,delete n.href;break;case"plusone":i=(i=t.href)?Fd(i):Gd(),n.url=i,i=t.db,o=Q(),null==i&&o&&(i=o.db,null==i&&(i=o.gwidget&&o.gwidget.db)),n.db=i||void 0,i=t.ecp,o=Q(),null==i&&o&&(i=o.ecp,null==i&&(i=o.gwidget&&o.gwidget.ecp)),n.ecp=i||void 0,delete n.href;break;case"signin":n.url=Gd()}for(var l in K.ILI&&(n.iloader="1"),delete n["data-onload"],delete n.rd,Hd)n[l]&&delete n[l];for(var c in n.gsrc=Q("iframes/:source:"),l=Q("inline/css"),"undefined"!==typeof l&&0<a&&l>=a&&(n.ic="1"),l=/^#|^fr-/,a={},n)C(n,c)&&l.test(c)&&(a[c.replace(l,"")]=n[c],delete n[c]);for(var u in c="q"==Q("iframes/"+e+"/params/si")?n:a,l=mc(),l)!C(l,u)||C(n,u)||C(a,u)||(c[u]=l[u]);for(var d in u=[].concat(Kd),(c=Q("iframes/"+e+"/methods"))&&"object"===typeof c&&Na.test(c.push)&&(u=u.concat(c)),t)C(t,d)&&/^on/.test(d)&&("plus"!=e||"onconnect"!=d)&&(u.push(d),delete n[d]);return delete n.callback,a._methods=u.join(","),fb(r,n,a)},Nd=["style","data-gapiscan"],Pd=function(e){for(var t=B(),a=0!=e.nodeName.toLowerCase().indexOf("g:"),o=0,r=e.attributes.length;o<r;o++){var n=e.attributes[o],i=n.name,s=n.value;0<=Oa.call(Nd,i)||a&&0!=i.indexOf("data-")||"null"===s||"specified"in n&&!n.specified||(a&&(i=i.substr(5)),t[i.toLowerCase()]=s)}return e=e.style,(a=Od(e&&e.height))&&(t.height=String(a)),(e=Od(e&&e.width))&&(t.width=String(e)),t},Od=function(e){var t=void 0;return"number"===typeof e?t=e:"string"===typeof e&&(t=parseInt(e,10)),t},Rd=function(){var e=K.drw;sc((function(t){if(e!==t.id&&4!=t.state&&"share"!=t.type){var a=t.id,o=t.type,r=t.url;t=t.userParams;var n=z.getElementById(a);if(n){var i=Md(o,t,0);i?(n=n.parentNode,r.replace(/#.*/,"").replace(/(\?|&)ic=1/,"")!==i.replace(/#.*/,"").replace(/(\?|&)ic=1/,"")&&(t.dontclear=!0,t.rd=!0,t.ri=!0,t.type=o,Qd(n,t),(o=R[n.lastChild.id])&&(o.oid=a),tc(a,4))):delete R[a]}else delete R[a]}}))},Sd,Td,X,Ud,Vd,Wd=/(?:^|\s)g-((\S)*)(?:$|\s)/,Xd={plusone:!0,autocomplete:!0,profile:!0,signin:!0,signin2:!0};Sd=A(K,"SW",B()),Td=A(K,"SA",B()),X=A(K,"SM",B()),Ud=A(K,"FW",[]),Vd=null;var Zd=function(e,t){Yd(void 0,!1,e,t)},Yd=function(e,t,a,o){L("ps0",!0),a=("string"===typeof a?document.getElementById(a):a)||z;var r=z.documentMode;if(a.querySelectorAll&&(!r||8<r)){r=o?[o]:Xa(Sd).concat(Xa(Td)).concat(Xa(X));for(var n=[],i=0;i<r.length;i++){var s=r[i];n.push(".g-"+s,"g\\:"+s)}r=a.querySelectorAll(n.join(","))}else r=a.getElementsByTagName("*");for(a=B(),n=0;n<r.length;n++){i=r[n];var l=i;s=o;var c=l.nodeName.toLowerCase(),u=void 0;if(l.getAttribute("data-gapiscan"))s=null;else{var d=c.indexOf("g:");0==d?u=c.substr(2):(d=(d=String(l.className||l.getAttribute("class")))&&Wd.exec(d))&&(u=d[1]),s=!u||!(Sd[u]||Td[u]||X[u])||s&&u!==s?null:u}s&&(Xd[s]||0==i.nodeName.toLowerCase().indexOf("g:")||0!=Xa(Pd(i)).length)&&(i.setAttribute("data-gapiscan",!0),A(a,s,[]).push(i))}if(t)for(var p in a)for(t=a[p],o=0;o<t.length;o++)t[o].setAttribute("data-onload",!0);for(var v in a)Ud.push(v);if(L("ps1",!0),(p=Ud.join(":"))||e)try{F.load(p,e)}catch(g){return void pc(g)}if($d(Vd||{}))for(var m in a){for(e=a[m],v=0,t=e.length;v<t;v++)e[v].removeAttribute("data-gapiscan");ae(m)}else{for(m in o=[],a)for(e=a[m],v=0,t=e.length;v<t;v++)r=e[v],be(m,r,Pd(r),o,t);ce(p,o)}},de=function(e){var t=A(F,e,{});t.go||(t.go=function(t){return Zd(t,e)},t.render=function(t,a){return a=a||{},a.type=e,Qd(t,a)})},ee=function(e){Sd[e]=!0},fe=function(e){Td[e]=!0},ge=function(e){X[e]=!0},ae=function(e,t){var a=sb(e);t&&a?(a(t),(a=t.iframeNode)&&a.setAttribute("data-gapiattached",!0)):F.load(e,(function(){var a=sb(e),o=t&&t.iframeNode,r=t&&t.userParams;o&&a?(a(t),o.setAttribute("data-gapiattached",!0)):(a=F[e].go,a("signin2"==e?o:o&&o.parentNode,r))}))},$d=function(){return!1},ce=function(){},be=function(e,t,a,o,r,n,i){switch(he(t,e,n)){case 0:e=X[e]?e+"_annotation":e,o={},o.iframeNode=t,o.userParams=a,ae(e,o);break;case 1:if(t.parentNode){for(var s in a)if((n=C(a,s))&&(n=a[s],n=!!n&&"object"===typeof n&&(!n.toString||n.toString===Object.prototype.toString||n.toString===Array.prototype.toString)),n)try{a[s]=$c(a[s])}catch(g){delete a[s]}if(n=!0,a.dontclear&&(n=!1),delete a.dontclear,rc(),s=Md(e,a,r),r=i||{},r.allowPost=1,r.attributes=Jd,r.dontclear=!n,i={},i.userParams=a,i.url=s,i.type=e,a.rd)var l=t;else l=document.createElement("div"),t.setAttribute("data-gapistub",!0),l.style.cssText="position:absolute;width:450px;left:-10000px;",t.parentNode.insertBefore(l,t);i.siteElement=l,l.id||(t=l,A(Ld,e,0),n="___"+e+"_"+Ld[e]++,t.id=n),t=B(),t[">type"]=e,D(a,t),n=s,a=l,s=r||{},t=s.attributes||{},E(!(s.allowPost||s.forcePost)||!t.onload,"onload is not supported by post iframe (allowPost or forcePost)"),r=t=n,Ad.test(t)&&(r=Q("iframes/"+r.substring(1)+"/url"),E(!!r,"Unknown iframe url config for - "+t)),n=hb(z,r.replace(Bd,Dd)),t=a.ownerDocument||z,l=0;do{r=s.id||["I",xd++,"_",(new Date).getTime()].join("")}while(t.getElementById(r)&&5>++l);E(5>l,"Error creating iframe id"),l={};var c={};t.documentMode&&9>t.documentMode&&(l.hostiemode=t.documentMode),D(s.queryParams||{},l),D(s.fragmentParams||{},c);var u=s.pfname,d=B();Q("iframes/dropLegacyIdParam")||(d.id=r),d._gfid=r,d.parent=t.location.protocol+"//"+t.location.host;var p=H(t.location.href,"parent");if(u=u||"",!u&&p&&(p=H(t.location.href,"_gfid","")||H(t.location.href,"id",""),u=H(t.location.href,"pfname",""),u=p?u+"/"+p:""),u||(p=Zc(H(t.location.href,"jcp","")))&&"object"==typeof p&&(u=(u=p.id)?p.pfname+"/"+u:""),d.pfname=u,s.connectWithJsonParam&&(p={},p.jcp=$c(d),d=p),p=H(n,"rpctoken")||l.rpctoken||c.rpctoken,p||(p=s.rpctoken||String(Math.round(1e8*(hd?qd():pd()))),d.rpctoken=p),s.rpctoken=p,D(d,s.connectWithQueryParams?l:c),p=t.location.href,d=B(),(u=H(p,"_bsh",K.bsh))&&(d._bsh=u),(p=qb(p))&&(d.jsh=p),s.hintInFragment?D(d,c):D(d,l),n=fb(n,l,c,s.paramsSerializer),c=B(),D(vd,c),D(s.attributes,c),c.name=c.id=r,c.src=n,s.eurl=n,l=s||{},d=!!l.allowPost,l.forcePost||d&&2e3<n.length){if(l=I(n),c.src="",s.dropDataPostorigin||(c["data-postorigin"]=n),n=zd(t,a,c,r),-1!=navigator.userAgent.indexOf("WebKit")){var m=n.contentWindow.document;m.open(),c=m.createElement("div"),d={},p=r+"_inner",d.name=p,d.src="",d.style="display:none",zd(t,c,d,p,s)}for(c=(s=l.query[0])?s.split("&"):[],s=[],d=0;d<c.length;d++)p=c[d].split("=",2),s.push([decodeURIComponent(p[0]),decodeURIComponent(p[1])]);for(l.query=[],c=db(l),E(ib.test(c),"Invalid URL: "+c),l=t.createElement("form"),l.method="POST",l.target=r,l.style.display="none",r=c instanceof v?c:Fa(c),xa(l,"HTMLFormElement").action=Da(r),r=0;r<s.length;r++)c=t.createElement("input"),c.type="hidden",c.name=s[r][0],c.value=s[r][1],l.appendChild(c);a.appendChild(l),l.submit(),l.parentNode.removeChild(l),m&&m.close(),m=n}else m=zd(t,a,c,r,s);i.iframeNode=m,i.id=m.getAttribute("id"),m=i.id,a=B(),a.id=m,a.userParams=i.userParams,a.url=i.url,a.type=i.type,a.state=1,R[m]=a,m=i}else m=null;m&&((i=m.id)&&o.push(i),ae(e,m))}},he=function(e,t,a){if(e&&1===e.nodeType&&t){if(a)return 1;if(X[t]){if(pb[e.nodeName.toLowerCase()])return(e=e.innerHTML)&&e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")?0:1}else{if(Td[t])return 0;if(Sd[t])return 1}}return null},Qd=function(e,t){var a=t.type;delete t.type;var o=("string"===typeof e?document.getElementById(e):e)||void 0;if(o){for(var r in e={},t)C(t,r)&&(e[r.toLowerCase()]=t[r]);e.rd=1,(t=!!e.ri)&&delete e.ri,r=[],be(a,o,e,r,0,t,void 0),ce(a,r)}else pc("string"==="gapi."+a+".render: missing element "+typeof e?e:"")};A(F,"platform",{}).go=Zd,$d=function(e){for(var t=["_c","jsl","h"],a=0;a<t.length&&e;a++)e=e[t[a]];return t=qb(La.href),!e||0!=e.indexOf("n;")&&0!=t.indexOf("n;")&&e!==t},ce=function(e,t){ie(e,t)};var lb=function(e){Yd(e,!0)},je=function(e,t){t=t||[];for(var a=0;a<t.length;++a)e(t[a]);for(e=0;e<t.length;e++)de(t[e])};N.push(["platform",function(e,t,a){if(Vd=a,t&&Ud.push(t),je(ee,e),je(fe,a._c.annotation),je(ge,a._c.bimodal),ic(),gc(),"explicit"!=Q("parsetags")){if(rb(e),nc(mc())&&!Q("disableRealtimeCallback")&&rc(),a&&(e=a.callback)){var o=Ya(e);delete a.callback}nb((function(){lb(o)}))}}]),F._pl=!0;var ke=function(e){if(e=(e=R[e])?e.oid:void 0,e){var t=z.getElementById(e);t&&t.parentNode.removeChild(t),delete R[e],ke(e)}},le=/^\{h:'/,me=/^!_/,ne="",ie=function(e,t){function a(){jb("message",o,"remove","de")}function o(o){var n=o.data,i=o.origin;if(oe(n,t)){var s=r;r=!1,s&&L("rqe"),pe(e,(function(){s&&L("rqd"),a();for(var e=A(K,"RPMQ",[]),t=0;t<e.length;t++)e[t]({data:n,origin:i})}))}}if(0!==t.length){ne=H(La.href,"pfname","");var r=!0;jb("message",o,"add","at"),ac(e,a)}},oe=function(e,t){if(e=String(e),le.test(e))return!0;var a=!1;if(me.test(e)&&(a=!0,e=e.substr(2)),!/^\{/.test(e))return!1;var o=Zc(e);if(!o)return!1;if(e=o.f,o.s&&e&&-1!=Oa.call(t,e)){if(("_renderstart"===o.s||o.s===ne+"/"+e+"::_renderstart")&&(o=o.a&&o.a[a?0:1],t=z.getElementById(e),tc(e,2),o&&t&&o.width&&o.height)){e:{if(a=t.parentNode,e=o||{},qc()){var r=t.id;if(r){if(o=(o=R[r])?o.state:void 0,1===o||4===o)break e;ke(r)}}(o=a.nextSibling)&&o.getAttribute&&o.getAttribute("data-gapistub")&&(a.parentNode.removeChild(o),a.style.cssText=""),o=e.width;var n=e.height,i=a.style;i.textIndent="0",i.margin="0",i.padding="0",i.background="transparent",i.borderStyle="none",i.cssFloat="none",i.styleFloat="none",i.lineHeight="normal",i.fontSize="1px",i.verticalAlign="baseline",a=a.style,a.display="inline-block",i=t.style,i.position="static",i.left="0",i.top="0",i.visibility="visible",o&&(a.width=i.width=o+"px"),n&&(a.height=i.height=n+"px"),e.verticalAlign&&(a.verticalAlign=e.verticalAlign),r&&tc(r,3)}t["data-csi-wdt"]=(new Date).getTime()}return!0}return!1},pe=function(e,t){ac(e,t)},qe=function(e,t){this.L=e,e=t||{},this.fa=Number(e.maxAge)||0,this.U=e.domain,this.X=e.path,this.ga=!!e.secure};qe.prototype.read=function(){for(var e=this.L+"=",t=document.cookie.split(/;\s*/),a=0;a<t.length;++a){var o=t[a];if(0==o.indexOf(e))return o.substr(e.length)}},qe.prototype.write=function(e,t){if(!re.test(this.L))throw"Invalid cookie name";if(!se.test(e))throw"Invalid cookie value";if(e=this.L+"="+e,this.U&&(e+=";domain="+this.U),this.X&&(e+=";path="+this.X),t="number"===typeof t?t:this.fa,0<=t){var a=new Date;a.setSeconds(a.getSeconds()+t),e+=";expires="+a.toUTCString()}return this.ga&&(e+=";secure"),document.cookie=e,!0},qe.prototype.clear=function(){this.write("",0)};var se=/^[-+/_=.:|%&a-zA-Z0-9@]*$/,re=/^[A-Z_][A-Z0-9_]{0,63}$/;qe.iterate=function(e){for(var t=document.cookie.split(/;\s*/),a=0;a<t.length;++a){var o=t[a].split("="),r=o.shift();e(r,o.join("="))}};var te=function(e){this.B=e};te.prototype.read=function(){if(Y.hasOwnProperty(this.B))return Y[this.B]},te.prototype.write=function(e){return Y[this.B]=e,!0},te.prototype.clear=function(){delete Y[this.B]};var Y={};te.iterate=function(e){for(var t in Y)Y.hasOwnProperty(t)&&e(t,Y[t])};var ue="https:"===window.location.protocol,ve=ue||"http:"===window.location.protocol?qe:te,we=function(e){var t=e.substr(1),a="",o=window.location.hostname;if(""!==t){if(a=parseInt(t,10),isNaN(a))return null;if(t=o.split("."),t.length<a-1)return null;t.length==a-1&&(o="."+o)}else o="";return{i:"S"==e.charAt(0),domain:o,l:a}},xe=function(){var e,t=null;return ve.iterate((function(a,o){0===a.indexOf("G_AUTHUSER_")&&(a=we(a.substring(11)),!e||a.i&&!e.i||a.i==e.i&&a.l>e.l)&&(e=a,t=o)})),{ea:e,F:t}},ye=function(e){if(0!==e.indexOf("GCSC"))return null;var t={W:!1};if(e=e.substr(4),!e)return t;var a=e.charAt(0);e=e.substr(1);var o=e.lastIndexOf("_");if(-1==o)return t;var r=we(e.substr(o+1));return null==r?t:(e=e.substring(0,o),"_"!==e.charAt(0)?t:(o="E"===a&&r.i,!o&&("U"!==a||r.i)||o&&!ue?t:{W:!0,i:o,ja:e.substr(1),domain:r.domain,l:r.l}))},ze=function(e){return e?(e=e.split("="),e[1]?e[1].split("|"):[]):[]},Ae=function(e){return e=e.split(":"),{clientId:e[0].split("=")[1],ia:ze(e[1]),la:ze(e[2]),ka:ze(e[3])}},Be=function(){var e,t=xe(),a=t.ea;if((t=t.F,null!==t)&&(ve.iterate((function(t,o){(t=ye(t))&&t.W&&t.i==a.i&&t.l==a.l&&(e=o)})),e)){var o=Ae(e),r=o&&o.ia[Number(t)];if(o=o&&o.clientId,r)return{F:t,ha:r,clientId:o}}return null},Z=function(){this.T=Ce};Z.prototype.$=function(){this.K||(this.v=0,this.K=!0,this.Y())},Z.prototype.Y=function(){this.K&&(this.T()?this.v=this.R:this.v=Math.min(2*(this.v||this.R),120),window.setTimeout(na(this.Y,this),1e3*this.v))},Z.prototype.v=0,Z.prototype.R=2,Z.prototype.T=null,Z.prototype.K=!1;for(var De=0;64>De;++De);var Ee=null;qc=function(){return K.oa=!0},rc=function(){K.oa=!0;var e=Be();(e=e&&e.F)&&hc("googleapis.config/sessionIndex",e),Ee||(Ee=A(K,"ss",new Z)),e=Ee,e.$&&e.$()};var Ce=function(){var e=Be(),t=e&&e.ha||null,a=e&&e.clientId;return ac("auth",{callback:function(){var e=x.gapi.auth,o={client_id:a,session_state:t};e.checkSessionState(o,(function(t){var a=o.session_state,r=Q("isLoggedIn");t=!Q("debug/forceIm")&&(a&&t||!a&&!t),(r=r!=t)&&(hc("isLoggedIn",t),rc(),Rd(),t||((t=e.signOut)?t():(t=e.setToken)&&t(null))),t=mc();var n=Q("savedUserState");a=e._guss(t.cookiepolicy),n=n!=a&&"undefined"!=typeof n,hc("savedUserState",a),(r||n)&&nc(t)&&!Q("disableRealtimeCallback")&&e._pimf(t,!0)}))}}),!0};L("bs0",!0,window.gapi._bs),L("bs1",!0),delete window.gapi._bs}.call(void 0);var gapiComplete=gapi.load("",{callback:window["gapi_onload"],_c:{jsl:{ci:{deviceType:"desktop","oauth-flow":{authUrl:"https://accounts.google.com/o/oauth2/auth",proxyUrl:"https://accounts.google.com/o/oauth2/postmessageRelay",disableOpt:!0,idpIframeUrl:"https://accounts.google.com/o/oauth2/iframe",usegapi:!1},debug:{reportExceptionRate:.05,forceIm:!1,rethrowException:!1,host:"https://apis.google.com"},enableMultilogin:!0,"googleapis.config":{auth:{useFirstPartyAuthV2:!0}},isPlusUser:!1,inline:{css:1},disableRealtimeCallback:!1,drive_share:{skipInitCommand:!0},csi:{rate:.01},client:{cors:!1},isLoggedIn:!0,signInDeprecation:{rate:0},include_granted_scopes:!0,llang:"pt",iframes:{youtube:{params:{location:["search","hash"]},url:":socialhost:/:session_prefix:_/widget/render/youtube?usegapi=1",methods:["scroll","openwindow"]},ytsubscribe:{url:"https://www.youtube.com/subscribe_embed?usegapi=1"},plus_circle:{params:{url:""},url:":socialhost:/:session_prefix::se:_/widget/plus/circle?usegapi=1"},plus_share:{params:{url:""},url:":socialhost:/:session_prefix::se:_/+1/sharebutton?plusShare=true&usegapi=1"},rbr_s:{params:{url:""},url:":socialhost:/:session_prefix::se:_/widget/render/recobarsimplescroller"},":source:":"3p",playemm:{url:"https://play.google.com/work/embedded/search?usegapi=1&usegapi=1"},savetoandroidpay:{url:"https://pay.google.com/gp/v/widget/save"},blogger:{params:{location:["search","hash"]},url:":socialhost:/:session_prefix:_/widget/render/blogger?usegapi=1",methods:["scroll","openwindow"]},evwidget:{params:{url:""},url:":socialhost:/:session_prefix:_/events/widget?usegapi=1"},partnersbadge:{url:"https://www.gstatic.com/partners/badge/templates/badge.html?usegapi=1"},dataconnector:{url:"https://dataconnector.corp.google.com/:session_prefix:ui/widgetview?usegapi=1"},surveyoptin:{url:"https://www.google.com/shopping/customerreviews/optin?usegapi=1"},":socialhost:":"https://apis.google.com",shortlists:{url:""},hangout:{url:"https://talkgadget.google.com/:session_prefix:talkgadget/_/widget"},plus_followers:{params:{url:""},url:":socialhost:/_/im/_/widget/render/plus/followers?usegapi=1"},post:{params:{url:""},url:":socialhost:/:session_prefix::im_prefix:_/widget/render/post?usegapi=1"},":gplus_url:":"https://plus.google.com",signin:{params:{url:""},url:":socialhost:/:session_prefix:_/widget/render/signin?usegapi=1",methods:["onauth"]},rbr_i:{params:{url:""},url:":socialhost:/:session_prefix::se:_/widget/render/recobarinvitation"},share:{url:":socialhost:/:session_prefix::im_prefix:_/widget/render/share?usegapi=1"},plusone:{params:{count:"",size:"",url:""},url:":socialhost:/:session_prefix::se:_/+1/fastbutton?usegapi=1"},comments:{params:{location:["search","hash"]},url:":socialhost:/:session_prefix:_/widget/render/comments?usegapi=1",methods:["scroll","openwindow"]},":im_socialhost:":"https://plus.googleapis.com",backdrop:{url:"https://clients3.google.com/cast/chromecast/home/widget/backdrop?usegapi=1"},visibility:{params:{url:""},url:":socialhost:/:session_prefix:_/widget/render/visibility?usegapi=1"},autocomplete:{params:{url:""},url:":socialhost:/:session_prefix:_/widget/render/autocomplete"},additnow:{url:"https://apis.google.com/marketplace/button?usegapi=1",methods:["launchurl"]},":signuphost:":"https://plus.google.com",ratingbadge:{url:"https://www.google.com/shopping/customerreviews/badge?usegapi=1"},appcirclepicker:{url:":socialhost:/:session_prefix:_/widget/render/appcirclepicker"},follow:{url:":socialhost:/:session_prefix:_/widget/render/follow?usegapi=1"},community:{url:":ctx_socialhost:/:session_prefix::im_prefix:_/widget/render/community?usegapi=1"},sharetoclassroom:{url:"https://classroom.google.com/sharewidget?usegapi=1"},ytshare:{params:{url:""},url:":socialhost:/:session_prefix:_/widget/render/ytshare?usegapi=1"},plus:{url:":socialhost:/:session_prefix:_/widget/render/badge?usegapi=1"},family_creation:{params:{url:""},url:"https://families.google.com/webcreation?usegapi=1&usegapi=1"},commentcount:{url:":socialhost:/:session_prefix:_/widget/render/commentcount?usegapi=1"},configurator:{url:":socialhost:/:session_prefix:_/plusbuttonconfigurator?usegapi=1"},zoomableimage:{url:"https://ssl.gstatic.com/microscope/embed/"},appfinder:{url:"https://workspace.google.com/:session_prefix:marketplace/appfinder?usegapi=1"},savetowallet:{url:"https://pay.google.com/gp/v/widget/save"},person:{url:":socialhost:/:session_prefix:_/widget/render/person?usegapi=1"},savetodrive:{url:"https://drive.google.com/savetodrivebutton?usegapi=1",methods:["save"]},page:{url:":socialhost:/:session_prefix:_/widget/render/page?usegapi=1"},card:{url:":socialhost:/:session_prefix:_/hovercard/card"}}},h:"m;/_/scs/apps-static/_/js/k=oz.gapi.pt_BR.l4Bv_WkVC6g.O/am=wQE/d=1/ct=zgms/rs=AGLTcCOuH5S2uqmF6E8zOW7n3yiqiwhzNQ/m=__features__",u:"https://apis.google.com/js/platform.js",hee:!0,fp:"821a251b140e4add32f87f4a7a08f044a59aa0e9",dpo:!1},platform:["additnow","backdrop","blogger","comments","commentcount","community","donation","family_creation","follow","hangout","health","page","partnersbadge","person","playemm","playreview","plus","plusone","post","ratingbadge","savetoandroidpay","savetodrive","savetowallet","sharetoclassroom","shortlists","signin2","surveyoptin","visibility","youtube","ytsubscribe","zoomableimage"],fp:"821a251b140e4add32f87f4a7a08f044a59aa0e9",annotation:["interactivepost","recobar","signin2","autocomplete","profile"],bimodal:["signin","share"]}})}).call(this,__webpack_require__("c8ba"))},6316:function(e,t,a){},"6bf6":function(e,t,a){"use strict";a("eefa")},"8a7f":function(e,t,a){},ac6c:function(e,t,a){"use strict";a("f8ac")},c2af:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"crm-seccion-container"},[t("div",{staticClass:"page-header"},[t("div",{staticClass:"header-content"},[t("h1",{staticClass:"page-title"},[e._v("\n        "+e._s(e.seccionActual?e.seccionActual.nombre:"Sección no encontrada")+"\n      ")])])]),e.cargando?t("div",{staticClass:"text-center"},[e._v("Cargando...")]):e.seccionActual?t("div",{staticClass:"main-content"},[e._e(),e.calendarEnabled?t("div",{staticClass:"view-selector-section"},[t("div",{staticClass:"view-tabs"},[t("button",{staticClass:"view-tab",class:{active:"table"===e.currentView},on:{click:function(t){e.currentView="table"}}},[t("i",{staticClass:"ti-list"}),e._v(" Tabla\n        ")]),e.calendarEnabled?t("button",{staticClass:"view-tab",class:{active:"calendar"===e.currentView},on:{click:function(t){e.currentView="calendar"}}},[t("i",{staticClass:"ti-calendar"}),e._v(" Calendario\n        ")]):e._e()])]):e._e(),"table"===e.currentView?t("div",{staticClass:"filtros-section"},[t("div",{staticClass:"filtros-header-collapsible",on:{click:e.toggleFiltros}},[t("div",{staticClass:"filtros-title"},[t("i",{staticClass:"ti-filter"}),t("span",[e._v("Filtros Avanzados")]),e.filtrosActivos?t("span",{staticClass:"filtros-count"},[e._v("("+e._s(Object.keys(e.filtrosActivos).length)+" activos)")]):e._e()]),t("div",{staticClass:"filtros-toggle"},[t("i",{staticClass:"ti-angle-down",class:{rotated:e.filtrosAbiertos}})])]),e.filtrosAbiertos?t("div",{staticClass:"filtros-content-collapsible"},[e.seccionActual&&e.seccionActual.columnas?t("FiltrosDinamicos",{attrs:{"campos-disponibles":e.seccionActual.columnas,secciones:e.secciones},on:{"filtros-cambiados":e.aplicarFiltros}}):t("div",{staticClass:"text-center text-muted"},[t("p",[e._v("Cargando campos de filtros...")])])],1):e._e()]):e._e(),"table"===e.currentView?t("div",{staticClass:"table-section"},[t("div",{staticClass:"table-header"},[t("div",{staticClass:"header-left"},[t("h2",[e._v("Datos de "+e._s(e.seccionActual.nombre))]),t("span",{staticClass:"record-count"},[e._v("\n            "+e._s(e.pagination.totalItems||0)+" registros\n          ")])]),t("div",{staticClass:"header-right"},[t("button",{staticClass:"btn-add-header",on:{click:function(t){e.showAddModal=!0}}},[t("i",{staticClass:"ti-plus"}),e._v(" Agregar Registro\n          ")])])]),t("div",{staticClass:"table-responsive"},[t("table",{staticClass:"table table-striped table-hover table-scrollable"},[t("thead",[t("tr",[e._l(e.seccionActual.columnas,(function(a){return t("th",{key:a.nombre||a,staticClass:"text-capitalize"},[e._v("\n                "+e._s((a.nombre||a).charAt(0).toUpperCase()+(a.nombre||a).slice(1))+"\n              ")])})),t("th",{staticClass:"text-center"},[e._v("Acciones")])],2)]),t("tbody",[e.loading?t("tr",[t("td",{staticClass:"text-center",attrs:{colspan:e.seccionActual.columnas.length+1}},[t("i",{staticClass:"ti-reload",staticStyle:{animation:"spin 1s linear infinite"}}),e._v("\n                Cargando registros...\n              ")])]):e.registros&&0!==e.registros.length?e._e():t("tr",[t("td",{staticClass:"text-center text-muted",attrs:{colspan:e.seccionActual.columnas.length+1}},[Object.keys(e.filtrosActivos).length>0?t("div",[t("i",{staticClass:"ti-search",staticStyle:{"font-size":"2rem",color:"#ccc","margin-bottom":"10px"}}),t("p",[e._v("No se encontraron registros con los filtros aplicados.")]),t("button",{staticClass:"btn-clear-filters",on:{click:e.limpiarFiltros}},[t("i",{staticClass:"ti-close"}),e._v(" Limpiar Filtros\n                  ")])]):t("div",[t("i",{staticClass:"ti-database",staticStyle:{"font-size":"2rem",color:"#ccc","margin-bottom":"10px"}}),t("p",[e._v("No hay registros aún.")]),t("button",{staticClass:"btn-add",on:{click:function(t){e.showAddModal=!0}}},[t("i",{staticClass:"ti-plus"}),e._v(" Agregar primer registro\n                  ")])])])]),e._l(e.registros,(function(a,o){return t("tr",{key:a._id||o},[e._l(e.seccionActual.columnas,(function(r){return t("td",{key:r.nombre||r},[a._id&&e.filaEditando!==a._id?["telefono"===r.tipo&&a.valores[r.nombre]?[t("span",{staticClass:"clickable-value phone-value",attrs:{title:"Clic para llamar a "+a.valores[r.nombre]},on:{click:function(t){return e.hacerLlamada(a.valores[r.nombre])}}},[e._v("\n                      "+e._s(a.valores[r.nombre])+"\n                    ")])]:"correo"===r.tipo&&a.valores[r.nombre]?[t("span",{staticClass:"clickable-value email-value",attrs:{title:"Clic para enviar correo a "+a.valores[r.nombre]},on:{click:function(t){return e.abrirCorreo(a.valores[r.nombre])}}},[e._v("\n                      "+e._s(a.valores[r.nombre])+"\n                    ")])]:"enlace"===r.tipo&&a.valores[r.nombre]?[t("span",{staticClass:"clickable-value link-value",attrs:{title:"Clic para abrir enlace"},on:{click:function(t){return e.abrirEnlace(a.valores[r.nombre])}}},[e._v("\n                      "+e._s(a.valores[r.nombre])+"\n                    ")])]:"textarea"===r.tipo&&a.valores[r.nombre]?[t("div",{staticClass:"textarea-preview"},[e._v("\n                      "+e._s(a.valores[r.nombre])+"\n                    ")])]:a.valores[r.nombre]&&a.valores[r.nombre].length>30?[t("span",{staticClass:"long-text",attrs:{title:a.valores[r.nombre]}},[e._v("\n                      "+e._s(a.valores[r.nombre])+"\n                    ")])]:[e._v("\n                    "+e._s(a.valores[r.nombre])+"\n                  ")]]:["relacional"===r.tipo?[t("div",{staticClass:"search-select-container"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.valores[r.nombre],expression:"fila.valores[columna.nombre]"}],staticClass:"form-control form-control-sm",attrs:{type:"text",placeholder:"Buscar en "+r.seccionRelacionada,autocomplete:"off"},domProps:{value:a.valores[r.nombre]},on:{input:[function(t){t.target.composing||e.$set(a.valores,r.nombre,t.target.value)},function(t){return e.filtrarOpciones(t,r,a,o)}],focus:function(t){return e.mostrarOpciones(r,a,o)}}}),e.opcionesVisibles[r.nombre+"_"+o]?t("div",{staticClass:"opciones-dropdown"},[e._l(e.opcionesFiltradas[r.nombre+"_"+o],(function(n){return t("div",{key:n,staticClass:"opcion-item",on:{mousedown:function(t){return t.preventDefault(),e.seleccionarOpcion(n,r.nombre,a,o)}}},[e._v("\n                          "+e._s(n)+"\n                        ")])})),0===e.opcionesFiltradas[r.nombre+"_"+o].length?t("div",{staticClass:"no-opciones"},[e._v("\n                          No se encontraron resultados\n                        ")]):e._e()],2):e._e()])]:"numero"===r.tipo?[t("input",{directives:[{name:"model",rawName:"v-model",value:a.valores[r.nombre],expression:"fila.valores[columna.nombre]"}],staticClass:"form-control form-control-sm",attrs:{type:"number",placeholder:"Ingrese "+r.nombre},domProps:{value:a.valores[r.nombre]},on:{input:function(t){t.target.composing||e.$set(a.valores,r.nombre,t.target.value)}}})]:"fecha"===r.tipo?[t("input",{directives:[{name:"model",rawName:"v-model",value:a.valores[r.nombre],expression:"fila.valores[columna.nombre]"}],staticClass:"form-control form-control-sm",attrs:{type:"date",placeholder:"Ingrese "+r.nombre},domProps:{value:a.valores[r.nombre]},on:{input:function(t){t.target.composing||e.$set(a.valores,r.nombre,t.target.value)}}})]:"select"===r.tipo?[t("select",{directives:[{name:"model",rawName:"v-model",value:a.valores[r.nombre],expression:"fila.valores[columna.nombre]"}],staticClass:"form-control form-control-sm",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a.valores,r.nombre,t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Selecciona una opción")]),e._l(r.opciones,(function(a){return t("option",{key:a,domProps:{value:a}},[e._v("\n                        "+e._s(a)+"\n                      ")])}))],2)]:"telefono"===r.tipo?[t("input",{directives:[{name:"model",rawName:"v-model",value:a.valores[r.nombre],expression:"fila.valores[columna.nombre]"}],staticClass:"form-control form-control-sm",attrs:{type:"tel",placeholder:"Ingrese "+r.nombre},domProps:{value:a.valores[r.nombre]},on:{input:function(t){t.target.composing||e.$set(a.valores,r.nombre,t.target.value)}}})]:"correo"===r.tipo?[t("input",{directives:[{name:"model",rawName:"v-model",value:a.valores[r.nombre],expression:"fila.valores[columna.nombre]"}],staticClass:"form-control form-control-sm",attrs:{type:"email",placeholder:"Ingrese "+r.nombre},domProps:{value:a.valores[r.nombre]},on:{input:function(t){t.target.composing||e.$set(a.valores,r.nombre,t.target.value)}}})]:"enlace"===r.tipo?[t("input",{directives:[{name:"model",rawName:"v-model",value:a.valores[r.nombre],expression:"fila.valores[columna.nombre]"}],staticClass:"form-control form-control-sm",attrs:{type:"url",placeholder:"Ingrese "+r.nombre},domProps:{value:a.valores[r.nombre]},on:{input:function(t){t.target.composing||e.$set(a.valores,r.nombre,t.target.value)}}})]:"textarea"===r.tipo?[t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.valores[r.nombre],expression:"fila.valores[columna.nombre]"}],staticClass:"form-control form-control-sm",staticStyle:{resize:"vertical","min-height":"60px"},attrs:{placeholder:"Ingrese "+r.nombre,rows:"3"},domProps:{value:a.valores[r.nombre]},on:{input:function(t){t.target.composing||e.$set(a.valores,r.nombre,t.target.value)}}})]:"archivo"===r.tipo?[t("div",{staticClass:"file-upload-container"},[t("FileUpload",{key:`file-upload-${a._id||o}-${r.nombre}`,attrs:{"case-id":e.seccionActual._id||e.seccionActual.id,"case-name":e.seccionActual.nombre},on:{"files-uploaded":e.onFilesUploaded},model:{value:a.valores[r.nombre],callback:function(t){e.$set(a.valores,r.nombre,t)},expression:"fila.valores[columna.nombre]"}})],1)]:[t("input",{directives:[{name:"model",rawName:"v-model",value:a.valores[r.nombre],expression:"fila.valores[columna.nombre]"}],staticClass:"form-control form-control-sm",attrs:{type:"text",placeholder:"Ingrese "+r.nombre},domProps:{value:a.valores[r.nombre]},on:{input:function(t){t.target.composing||e.$set(a.valores,r.nombre,t.target.value)}}})]]],2)})),t("td",{staticClass:"text-center",staticStyle:{width:"150px","min-width":"150px"}},[t("button",{staticClass:"btn-view",attrs:{title:"Ver registro completo"},on:{click:function(t){return e.verRegistro(a)}}},[t("i",{staticClass:"ti-eye"})]),t("button",{staticClass:"btn-edit",attrs:{title:"Editar"},on:{click:function(t){e.filaEditando=a._id}}},[t("i",{staticClass:"ti-pencil"})]),t("button",{staticClass:"btn-delete",attrs:{title:"Eliminar fila"},on:{click:function(t){return e.eliminarFila(o)}}},[t("i",{staticClass:"ti-trash"})]),a._id?e.filaEditando===a._id?[t("button",{staticClass:"btn-add",attrs:{title:"Guardar cambios"},on:{click:function(t){e.guardarFilaEditada(a,o),e.filaEditando=null}}},[t("i",{staticClass:"ti-save"})]),t("button",{staticClass:"btn-edit",attrs:{title:"Cancelar"},on:{click:function(t){e.revertirFila(a,o),e.filaEditando=null}}},[t("i",{staticClass:"ti-close"})])]:e._e():[t("button",{staticClass:"btn-add",attrs:{title:"Guardar"},on:{click:function(t){return e.guardarFilaEditada(a,o)}}},[t("i",{staticClass:"ti-save"})])]],2)],2)}))],2)])]),e.pagination&&e.pagination.totalPages>1?t("div",{staticClass:"paginacion-controls"},[t("div",{staticClass:"pagination-info"},[t("span",[e._v("\n            Mostrando "+e._s(e.pagination.currentPage*e.pagination.itemsPerPage-e.pagination.itemsPerPage+1)+" \n            a "+e._s(Math.min(e.pagination.currentPage*e.pagination.itemsPerPage,e.pagination.totalItems))+" \n            de "+e._s(e.pagination.totalItems)+" registros\n          ")])]),t("div",{staticClass:"pagination-buttons"},[t("button",{staticClass:"btn-pagination",attrs:{disabled:!e.pagination.hasPrevPage},on:{click:function(t){return e.cambiarPagina(e.pagination.prevPage)}}},[t("i",{staticClass:"ti-angle-left"}),e._v(" Anterior\n          ")]),t("span",{staticClass:"page-info"},[e._v("\n            Página "+e._s(e.pagination.currentPage)+" de "+e._s(e.pagination.totalPages)+"\n          ")]),t("button",{staticClass:"btn-pagination",attrs:{disabled:!e.pagination.hasNextPage},on:{click:function(t){return e.cambiarPagina(e.pagination.nextPage)}}},[e._v("\n            Siguiente "),t("i",{staticClass:"ti-angle-right"})])])]):e._e()]):e._e(),"calendar"===e.currentView?t("div",{staticClass:"calendar-section"},[e.calendarConfigs.length>1?t("div",{staticClass:"calendar-selector"},[t("h6",[e._v("Calendarios de "+e._s(e.seccionActual.nombre)+":")]),t("div",{staticClass:"calendar-tabs"},e._l(e.calendarConfigs,(function(a){return t("button",{key:a._id,staticClass:"calendar-tab",class:{active:e.selectedCalendar&&e.selectedCalendar._id===a._id},on:{click:function(t){return e.selectCalendar(a)}}},[t("span",{staticClass:"calendar-color",style:{backgroundColor:a.defaultColor}}),e._v("\n            "+e._s(a.title)+"\n            "),a.enabled?e._e():t("span",{staticClass:"disabled-badge"},[e._v("Deshabilitado")])])})),0)]):e._e(),t("div",{staticClass:"table-header"},[t("h2",[e._v(e._s(e.calendarTitle||"Calendario"))]),t("div",{staticClass:"calendar-controls"},[t("span",{staticClass:"record-count"},[e._v(e._s(e.calendarEvents.length)+" eventos")]),e._e()])]),e._e(),e.calendarEnabled&&e.dateFieldName&&e.titleFieldName?t("CalendarView",{key:"calendar-"+(e.seccionActual?e.seccionActual._id||e.seccionActual.id:"no-section"),attrs:{events:e.calendarEvents,"date-field":e.dateFieldName,"title-field":e.titleFieldName,"available-fields":{},columns:e.seccionActual.columnas,loading:e.calendarLoading},on:{"add-event":e.addCalendarEvent,"update-event":e.updateCalendarEvent,"delete-event":e.deleteCalendarEvent,"month-changed":e.loadCalendarData}}):e._e(),e.calendarEnabled&&e.dateFieldName&&e.titleFieldName&&0===e.calendarEvents.length?t("div",{staticClass:"no-events"},[t("i",{staticClass:"ti-calendar",staticStyle:{"font-size":"3rem",color:"#ccc","margin-bottom":"15px"}}),t("h6",[e._v("No hay eventos en el calendario")]),t("p",[e._v("Agrega algunos registros con fechas para verlos en el calendario.")])]):e._e()],1):e._e()]):t("div",{staticClass:"main-content"},[t("div",{staticClass:"table-section"},[t("div",{staticClass:"text-center"},[t("i",{staticClass:"ti-alert",staticStyle:{"font-size":"4rem",color:"#dc3545","margin-bottom":"20px"}}),t("h3",[e._v("Sección no encontrada")]),t("p",[e._v("La sección que buscas no existe o ha sido eliminada.")]),t("button",{staticClass:"btn-add",on:{click:function(t){return e.$router.push("/crm-dinamico")}}},[t("i",{staticClass:"ti-arrow-left"}),e._v(" Volver al CRM\n        ")])])])]),t("b-modal",{attrs:{title:"Confirmar acción","hide-footer":""},model:{value:e.showClearModal,callback:function(t){e.showClearModal=t},expression:"showClearModal"}},[t("div",{staticClass:"text-center"},[t("p",[e._v("¿Estás seguro de que quieres eliminar todos los datos de la sección "),t("strong",[e._v(e._s(e.seccionActual?e.seccionActual.nombre:""))]),e._v("?")]),t("p",{staticClass:"text-danger"},[e._v("Esta acción no se puede deshacer.")]),t("div",{staticClass:"mt-3"},[t("b-button",{staticClass:"mr-2",attrs:{variant:"danger"},on:{click:e.confirmarLimpiarSeccion}},[e._v("Eliminar Todo")]),t("b-button",{attrs:{variant:"secondary"},on:{click:function(t){e.showClearModal=!1}}},[e._v("Cancelar")])],1)])]),t("b-modal",{attrs:{title:"Configuración del Calendario",size:"lg","hide-footer":""},model:{value:e.showCalendarSettings,callback:function(t){e.showCalendarSettings=t},expression:"showCalendarSettings"}},[t("div",{staticClass:"calendar-settings"},[t("div",{staticClass:"setting-section"},[t("h5",[e._v("Seleccionar Calendario")]),t("p",[e._v("Elige un calendario existente o crea uno nuevo:")]),t("div",{staticClass:"calendar-selection"},[t("div",{staticClass:"calendar-options"},[e._l(e.calendarConfigs,(function(a){return t("div",{key:a._id,staticClass:"calendar-option",class:{active:e.selectedCalendar&&e.selectedCalendar._id===a._id},on:{click:function(t){return e.selectCalendarFromModal(a)}}},[t("div",{staticClass:"option-header"},[t("span",{staticClass:"option-color",style:{backgroundColor:a.defaultColor}}),t("span",{staticClass:"option-title"},[e._v(e._s(a.title))]),a.enabled?e._e():t("span",{staticClass:"option-status"},[e._v("Deshabilitado")])]),t("div",{staticClass:"option-details"},[t("small",[e._v(e._s(a.dateField)+" → "+e._s(a.titleField))])])])})),t("div",{staticClass:"calendar-option new-option",on:{click:e.createNewCalendar}},[t("div",{staticClass:"option-header"},[t("span",{staticClass:"option-icon"},[e._v("+")]),t("span",{staticClass:"option-title"},[e._v("Crear Nuevo Calendario")])]),t("div",{staticClass:"option-details"},[t("small",[e._v("Configurar desde cero")])])])],2)])]),e.selectedCalendar||e.calendarEnabled?t("div",{staticClass:"setting-section"},[t("h5",[e._v(e._s(e.selectedCalendar?"Configurar: "+e.selectedCalendar.title:"Nuevo Calendario"))]),t("p",[e._v("Configura los campos y opciones del calendario:")]),t("div",{staticClass:"form-group"},[t("label",{staticClass:"checkbox-label"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.calendarEnabled,expression:"calendarEnabled"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.calendarEnabled)?e._i(e.calendarEnabled,null)>-1:e.calendarEnabled},on:{change:[function(t){var a=e.calendarEnabled,o=t.target,r=!!o.checked;if(Array.isArray(a)){var n=null,i=e._i(a,n);o.checked?i<0&&(e.calendarEnabled=a.concat([n])):i>-1&&(e.calendarEnabled=a.slice(0,i).concat(a.slice(i+1)))}else e.calendarEnabled=r},e.toggleCalendar]}}),t("span",{staticClass:"checkmark"}),e._v("\n            Habilitar calendario para esta sección\n          ")])])]):e._e(),e.calendarEnabled?t("div",{staticClass:"setting-section"},[t("h6",[e._v("Configuración de Campos")]),t("div",{staticClass:"form-group"},[t("label",[e._v("Título del calendario:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.calendarTitle,expression:"calendarTitle"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Ej: Calendario de Citas, Eventos del Mes...",disabled:!e.calendarEnabled},domProps:{value:e.calendarTitle},on:{input:[function(t){t.target.composing||(e.calendarTitle=t.target.value)},e.onTitleChange]}}),t("small",{staticClass:"text-muted"},[e._v('Valor actual: "'+e._s(e.calendarTitle)+'"')])]),t("div",{staticClass:"form-group"},[t("label",[e._v("Campo de fecha:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.dateFieldName,expression:"dateFieldName"}],staticClass:"form-control",attrs:{disabled:!e.calendarEnabled},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.dateFieldName=t.target.multiple?a:a[0]}}},[t("option",{attrs:{value:""}},[e._v("Selecciona un campo de fecha")]),e._l(e.dateFields,(function(a){return t("option",{key:a.nombre,domProps:{value:a.nombre}},[e._v("\n              "+e._s(a.nombre)+"\n            ")])}))],2)]),t("div",{staticClass:"form-group"},[t("label",[e._v("Campo de título:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.titleFieldName,expression:"titleFieldName"}],staticClass:"form-control",attrs:{disabled:!e.calendarEnabled},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.titleFieldName=t.target.multiple?a:a[0]}}},[t("option",{attrs:{value:""}},[e._v("Selecciona un campo para el título")]),e._l(e.textFields,(function(a){return t("option",{key:a.nombre,domProps:{value:a.nombre}},[e._v("\n              "+e._s(a.nombre)+"\n            ")])}))],2)]),t("div",{staticClass:"form-group"},[t("label",[e._v("Campos para mostrar en el calendario:")]),t("div",{staticClass:"fields-checkboxes"},[0===e.availableFieldsForCalendar.length?t("div",{staticClass:"no-fields"},[t("p",[e._v("No hay campos adicionales disponibles para mostrar.")])]):e._l(e.availableFieldsForCalendar,(function(a){return t("div",{key:a,staticClass:"field-checkbox"},[t("label",{staticClass:"checkbox-label"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedDisplayFields,expression:"selectedDisplayFields"}],attrs:{type:"checkbox",disabled:!e.calendarEnabled},domProps:{value:a,checked:Array.isArray(e.selectedDisplayFields)?e._i(e.selectedDisplayFields,a)>-1:e.selectedDisplayFields},on:{change:function(t){var o=e.selectedDisplayFields,r=t.target,n=!!r.checked;if(Array.isArray(o)){var i=a,s=e._i(o,i);r.checked?s<0&&(e.selectedDisplayFields=o.concat([i])):s>-1&&(e.selectedDisplayFields=o.slice(0,s).concat(o.slice(s+1)))}else e.selectedDisplayFields=n}}}),t("span",{staticClass:"checkmark"}),e._v("\n                  "+e._s(a)+"\n                ")])])}))],2)]),t("div",{staticClass:"form-group"},[t("label",[e._v("Color por defecto:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.defaultEventColor,expression:"defaultEventColor"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.defaultEventColor=t.target.multiple?a:a[0]}}},[t("option",{attrs:{value:"#007bff"}},[e._v("Azul")]),t("option",{attrs:{value:"#28a745"}},[e._v("Verde")]),t("option",{attrs:{value:"#ffc107"}},[e._v("Amarillo")]),t("option",{attrs:{value:"#dc3545"}},[e._v("Rojo")]),t("option",{attrs:{value:"#6f42c1"}},[e._v("Púrpura")]),t("option",{attrs:{value:"#fd7e14"}},[e._v("Naranja")])])]),t("div",{staticClass:"form-group"},[t("label",[e._v("Campo para colores dinámicos (opcional):")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.colorFieldName,expression:"colorFieldName"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.colorFieldName=t.target.multiple?a:a[0]}}},[t("option",{attrs:{value:""}},[e._v("Sin colores dinámicos")]),e._l(e.selectFields,(function(a){return t("option",{key:a.nombre,domProps:{value:a.nombre}},[e._v("\n              "+e._s(a.nombre)+" ("+e._s(a.opciones?a.opciones.length:0)+" opciones)\n            ")])}))],2),t("small",{staticClass:"text-muted"},[e._v("Si seleccionas un campo select, los eventos se colorearán automáticamente según su valor")])]),e.colorFieldName&&e.selectedColorField?t("div",{staticClass:"form-group"},[t("label",[e._v('Configuración de colores para "'+e._s(e.colorFieldName)+'":')]),t("div",{staticClass:"color-mapping"},e._l(e.selectedColorField.opciones,(function(a){return t("div",{key:a,staticClass:"color-option"},[t("label",{staticClass:"color-label"},[e._v(e._s(a)+":")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.colorMapping[a],expression:"colorMapping[opcion]"}],staticClass:"form-control color-select",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.colorMapping,a,t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:"#007bff"}},[e._v("Azul")]),t("option",{attrs:{value:"#28a745"}},[e._v("Verde")]),t("option",{attrs:{value:"#ffc107"}},[e._v("Amarillo")]),t("option",{attrs:{value:"#dc3545"}},[e._v("Rojo")]),t("option",{attrs:{value:"#6f42c1"}},[e._v("Púrpura")]),t("option",{attrs:{value:"#fd7e14"}},[e._v("Naranja")]),t("option",{attrs:{value:"#20c997"}},[e._v("Verde agua")]),t("option",{attrs:{value:"#6c757d"}},[e._v("Gris")]),t("option",{attrs:{value:"#e83e8c"}},[e._v("Rosa")]),t("option",{attrs:{value:"#17a2b8"}},[e._v("Azul claro")])]),t("div",{staticClass:"color-preview",style:{backgroundColor:e.colorMapping[a]||"#007bff"}})])})),0)]):e._e()]):e._e(),t("div",{staticClass:"setting-actions"},[t("div",{staticClass:"config-status"},[e.calendarEnabled&&e.dateFieldName&&e.titleFieldName?t("span",{staticClass:"status-ok"},[t("i",{staticClass:"ti-check"}),e._v(" Configuración válida\n            ")]):e.calendarEnabled?t("span",{staticClass:"status-warning"},[t("i",{staticClass:"ti-alert"}),e._v(" Campos requeridos incompletos\n            ")]):t("span",{staticClass:"status-disabled"},[t("i",{staticClass:"ti-close"}),e._v(" Calendario deshabilitado\n            ")])]),t("div",{staticClass:"action-buttons"},[t("button",{staticClass:"btn-save",on:{click:e.saveCalendarSettings}},[t("i",{staticClass:"ti-save"}),e._v(" Guardar en Servidor\n            ")]),t("button",{staticClass:"btn-cancel",on:{click:function(t){e.showCalendarSettings=!1}}},[t("i",{staticClass:"ti-close"}),e._v(" Cancelar\n            ")])])])])]),t("b-modal",{attrs:{title:"Configuración de Campos",size:"lg","hide-footer":""},on:{hidden:e.limpiarFormularioCampo},model:{value:e.showFieldsModal,callback:function(t){e.showFieldsModal=t},expression:"showFieldsModal"}},[t("div",{staticClass:"fields-modal-content"},[t("div",{staticClass:"new-field-section"},[t("h5",{staticClass:"section-title"},[t("i",{staticClass:"ti-plus"}),e._v(" Agregar Nuevo Campo\n        ")]),t("div",{staticClass:"field-form-modal"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-4"},[t("div",{staticClass:"form-group"},[t("label",[e._v("Nombre del campo")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevoCampo.nombre,expression:"nuevoCampo.nombre"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Ej: nombre, email, teléfono..."},domProps:{value:e.nuevoCampo.nombre},on:{input:function(t){t.target.composing||e.$set(e.nuevoCampo,"nombre",t.target.value)}}})])]),t("div",{staticClass:"col-md-3"},[t("div",{staticClass:"form-group"},[t("label",[e._v("Tipo de campo")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.nuevoCampo.tipo,expression:"nuevoCampo.tipo"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.nuevoCampo,"tipo",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:"texto"}},[e._v("Texto")]),t("option",{attrs:{value:"textarea"}},[e._v("Área de texto")]),t("option",{attrs:{value:"numero"}},[e._v("Número")]),t("option",{attrs:{value:"fecha"}},[e._v("Fecha")]),t("option",{attrs:{value:"telefono"}},[e._v("Teléfono")]),t("option",{attrs:{value:"correo"}},[e._v("Correo")]),t("option",{attrs:{value:"enlace"}},[e._v("Enlace")]),t("option",{attrs:{value:"select"}},[e._v("Select")]),t("option",{attrs:{value:"relacional"}},[e._v("Relacional")]),t("option",{attrs:{value:"archivo"}},[e._v("Archivo (Google Drive)")])])])]),"relacional"===e.nuevoCampo.tipo?t("div",{staticClass:"col-md-3"},[t("div",{staticClass:"form-group"},[t("label",[e._v("Sección relacionada")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.nuevoCampo.seccionRelacionada,expression:"nuevoCampo.seccionRelacionada"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.nuevoCampo,"seccionRelacionada",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:""}},[e._v("Selecciona una sección")]),e._l(e.otrasSecciones,(function(a){return t("option",{key:a.nombre,domProps:{value:a.nombre}},[e._v("\n                    "+e._s(a.nombre)+"\n                  ")])}))],2)])]):e._e(),"relacional"===e.nuevoCampo.tipo?t("div",{staticClass:"col-md-2"},[t("div",{staticClass:"form-group"},[t("label",[e._v("Campo a mostrar")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.nuevoCampo.campoMostrar,expression:"nuevoCampo.campoMostrar"}],staticClass:"form-control",attrs:{disabled:!e.nuevoCampo.seccionRelacionada},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.nuevoCampo,"campoMostrar",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:""}},[e._v("Selecciona campo")]),e._l(e.camposSeccionRelacionada,(function(a){return t("option",{key:a,domProps:{value:a}},[e._v("\n                    "+e._s(a)+"\n                  ")])}))],2)])]):e._e(),"select"===e.nuevoCampo.tipo?t("div",{staticClass:"col-md-5"},[t("div",{staticClass:"form-group"},[t("label",[e._v("Opciones del select (separadas por comas)")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevoCampo.opcionesSelect,expression:"nuevoCampo.opcionesSelect"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Ej: Opción 1, Opción 2, Opción 3"},domProps:{value:e.nuevoCampo.opcionesSelect},on:{input:function(t){t.target.composing||e.$set(e.nuevoCampo,"opcionesSelect",t.target.value)}}}),t("small",{staticClass:"text-muted"},[e._v("Ingresa las opciones separadas por comas")])])]):e._e()]),t("div",{staticClass:"row mt-3"},[t("div",{staticClass:"col-12"},[t("button",{staticClass:"btn-add text-center",staticStyle:{width:"100%","justify-content":"center"},attrs:{disabled:!e.puedeAgregarCampo},on:{click:e.agregarCampo}},[t("i",{staticClass:"ti-plus"}),e._v(" Agregar Campo\n              ")]),t("button",{staticClass:"btn-secondary ml-2 mt-3",on:{click:e.limpiarFormularioCampo}},[t("i",{staticClass:"ti-refresh"}),e._v(" Limpiar\n              ")])])])])]),e.seccionActual&&e.seccionActual.columnas.length>0?t("div",{staticClass:"existing-fields-section"},[t("h5",{staticClass:"section-title"},[t("i",{staticClass:"ti-list"}),e._v(" Campos Existentes ("+e._s(e.seccionActual.columnas.length)+")\n        ")]),e.mensajeExitoCampo?t("div",{staticClass:"alert alert-success",staticStyle:{"margin-bottom":"16px"}},[e._v("\n          "+e._s(e.mensajeExitoCampo)+"\n        ")]):e._e(),t("div",{staticClass:"fields-accordion"},e._l(e.seccionActual.columnas,(function(a,o){return t("div",{key:o,staticClass:"accordion-item"},[t("button",{staticClass:"accordion-header",on:{click:function(t){e.campoAcordeonAbierto=e.campoAcordeonAbierto===o?null:o}}},[t("span",[e._v("\n                "+e._s((a.nombre||a).charAt(0).toUpperCase()+(a.nombre||a).slice(1))+"\n              ")]),t("span",{staticClass:"field-type-badge",class:e.getTipoClase(a)},[e._v("\n                "+e._s(e.getTipoTexto(a))+"\n              ")]),t("span",{staticClass:"accordion-arrow",class:{open:e.campoAcordeonAbierto===o}},[e._v("▼")])]),e.campoAcordeonAbierto===o?t("div",{staticClass:"accordion-body"},[t("div",{staticClass:"field-details"},[t("div",{staticClass:"field-info-grid"},[t("div",{staticClass:"field-info-item"},[t("label",[e._v("Nombre:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.seccionActual.columnas[o].nombre,expression:"seccionActual.columnas[index].nombre"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Nombre del campo"},domProps:{value:e.seccionActual.columnas[o].nombre},on:{input:function(t){t.target.composing||e.$set(e.seccionActual.columnas[o],"nombre",t.target.value)}}})]),t("div",{staticClass:"field-info-item"},[t("label",[e._v("Tipo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.seccionActual.columnas[o].tipo,expression:"seccionActual.columnas[index].tipo"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.seccionActual.columnas[o],"tipo",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:"texto"}},[e._v("Texto")]),t("option",{attrs:{value:"textarea"}},[e._v("Área de texto")]),t("option",{attrs:{value:"numero"}},[e._v("Número")]),t("option",{attrs:{value:"fecha"}},[e._v("Fecha")]),t("option",{attrs:{value:"telefono"}},[e._v("Teléfono")]),t("option",{attrs:{value:"correo"}},[e._v("Correo")]),t("option",{attrs:{value:"enlace"}},[e._v("Enlace")]),t("option",{attrs:{value:"select"}},[e._v("Select")]),t("option",{attrs:{value:"relacional"}},[e._v("Relacional")]),t("option",{attrs:{value:"archivo"}},[e._v("Archivo (Google Drive)")])])]),"relacional"===e.seccionActual.columnas[o].tipo?t("div",{staticClass:"field-info-item"},[t("label",[e._v("Sección relacionada:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.seccionActual.columnas[o].seccionRelacionada,expression:"seccionActual.columnas[index].seccionRelacionada"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.seccionActual.columnas[o],"seccionRelacionada",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:""}},[e._v("Selecciona una sección")]),e._l(e.otrasSecciones,(function(a){return t("option",{key:a.nombre,domProps:{value:a.nombre}},[e._v("\n                        "+e._s(a.nombre)+"\n                      ")])}))],2)]):e._e(),"relacional"===e.seccionActual.columnas[o].tipo?t("div",{staticClass:"field-info-item"},[t("label",[e._v("Campo a mostrar:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.seccionActual.columnas[o].campoMostrar,expression:"seccionActual.columnas[index].campoMostrar"}],staticClass:"form-control",attrs:{disabled:!e.seccionActual.columnas[o].seccionRelacionada},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.seccionActual.columnas[o],"campoMostrar",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:""}},[e._v("Selecciona campo")]),e._l(e.camposSeccionRelacionada,(function(a){return t("option",{key:a,domProps:{value:a}},[e._v("\n                        "+e._s(a)+"\n                      ")])}))],2)]):e._e(),"select"===e.seccionActual.columnas[o].tipo?t("div",{staticClass:"field-info-item"},[t("label",[e._v("Opciones del select:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.seccionActual.columnas[o].opcionesString,expression:"seccionActual.columnas[index].opcionesString"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Opciones separadas por comas"},domProps:{value:e.seccionActual.columnas[o].opcionesString},on:{input:[function(t){t.target.composing||e.$set(e.seccionActual.columnas[o],"opcionesString",t.target.value)},function(t){return e.actualizarOpcionesSelect(o)}]}}),t("small",{staticClass:"text-muted"},[e._v("Opciones actuales: "+e._s(e.seccionActual.columnas[o].opciones?e.seccionActual.columnas[o].opciones.join(", "):"Ninguna"))])]):e._e()]),t("div",{staticClass:"field-actions"},[t("button",{staticClass:"btn-add",on:{click:function(t){return e.guardarCambiosCampo(o)}}},[t("i",{staticClass:"ti-save"}),e._v(" Guardar Cambios\n                  ")]),t("button",{staticClass:"btn-delete-sm",attrs:{title:"Eliminar campo"},on:{click:function(t){return e.eliminarCampo(o)}}},[t("i",{staticClass:"ti-trash"}),e._v(" Eliminar Campo\n                  ")])])])]):e._e()])})),0)]):t("div",{staticClass:"empty-fields-state"},[t("div",{staticClass:"text-center"},[t("i",{staticClass:"ti-folder",staticStyle:{"font-size":"3rem",color:"#ccc","margin-bottom":"15px"}}),t("h6",[e._v("No hay campos definidos")]),t("p",[e._v("Agrega campos para comenzar a gestionar datos en esta sección.")])])])])]),t("b-modal",{attrs:{title:"Detalles del Registro",size:"lg","hide-footer":""},model:{value:e.showViewModal,callback:function(t){e.showViewModal=t},expression:"showViewModal"}},[e.registroSeleccionado?t("div",{staticClass:"view-record-modal"},[t("div",{staticClass:"record-header"},[t("h4",{staticClass:"record-title"},[t("i",{staticClass:"ti-database"}),e._v("\n          Registro de "+e._s(e.seccionActual?e.seccionActual.nombre:"Sección")+"\n        ")])]),t("div",{staticClass:"record-content"},[t("div",{staticClass:"fields-grid"},e._l(e.seccionActual.columnas,(function(a){return t("div",{key:a.nombre,staticClass:"field-item"},[t("div",{staticClass:"field-label"},[e._v("\n              "+e._s((a.nombre||a).charAt(0).toUpperCase()+(a.nombre||a).slice(1))+"\n            ")]),t("div",{staticClass:"field-value",class:e.getFieldValueClass(a)},["telefono"===a.tipo&&e.registroSeleccionado.valores[a.nombre]?[t("span",{staticClass:"clickable-value phone-value",attrs:{title:"Clic para llamar a "+e.registroSeleccionado.valores[a.nombre]},on:{click:function(t){return e.hacerLlamada(e.registroSeleccionado.valores[a.nombre])}}},[e._v("\n                  "+e._s(e.registroSeleccionado.valores[a.nombre])+"\n                ")])]:"correo"===a.tipo&&e.registroSeleccionado.valores[a.nombre]?[t("span",{staticClass:"clickable-value email-value",attrs:{title:"Clic para enviar correo a "+e.registroSeleccionado.valores[a.nombre]},on:{click:function(t){return e.abrirCorreo(e.registroSeleccionado.valores[a.nombre])}}},[e._v("\n                  "+e._s(e.registroSeleccionado.valores[a.nombre])+"\n                ")])]:"enlace"===a.tipo&&e.registroSeleccionado.valores[a.nombre]?[t("span",{staticClass:"clickable-value link-value",attrs:{title:"Clic para abrir enlace"},on:{click:function(t){return e.abrirEnlace(e.registroSeleccionado.valores[a.nombre])}}},[e._v("\n                  "+e._s(e.registroSeleccionado.valores[a.nombre])+"\n                ")])]:"textarea"===a.tipo&&e.registroSeleccionado.valores[a.nombre]?[t("div",{staticClass:"textarea-content"},[t("pre",[e._v(e._s(e.registroSeleccionado.valores[a.nombre]))])])]:"fecha"===a.tipo&&e.registroSeleccionado.valores[a.nombre]?[t("span",{staticClass:"date-value"},[e._v("\n                  "+e._s(e.formatearFecha(e.registroSeleccionado.valores[a.nombre]))+"\n                ")])]:"archivo"===a.tipo&&e.registroSeleccionado.valores[a.nombre]?[t("div",{staticClass:"file-list"},e._l(e.registroSeleccionado.valores[a.nombre],(function(a,o){return t("div",{key:o,staticClass:"file-item"},[t("i",{staticClass:"ti-file"}),t("span",[e._v(e._s(a.name||a))])])})),0)]:"select"===a.tipo&&e.registroSeleccionado.valores[a.nombre]?[t("span",{staticClass:"select-value"},[e._v("\n                  "+e._s(e.registroSeleccionado.valores[a.nombre])+"\n                ")])]:"numero"===a.tipo&&e.registroSeleccionado.valores[a.nombre]?[t("span",{staticClass:"number-value"},[e._v("\n                  "+e._s(e.registroSeleccionado.valores[a.nombre])+"\n                ")])]:[t("span",{staticClass:"text-value"},[e._v("\n                  "+e._s(e.registroSeleccionado.valores[a.nombre]||"Sin valor")+"\n                ")])]],2)])})),0)]),t("div",{staticClass:"record-footer"},[t("button",{staticClass:"btn-modal-secondary",on:{click:function(t){e.showViewModal=!1}}},[t("i",{staticClass:"ti-close"}),e._v(" Cerrar\n        ")]),t("button",{staticClass:"btn-modal-primary",on:{click:e.editarDesdeModal}},[t("i",{staticClass:"ti-pencil"}),e._v(" Editar Registro\n        ")])])]):e._e()]),t("b-modal",{attrs:{title:"Agregar Nuevo Registro",size:"lg","hide-footer":""},model:{value:e.showAddModal,callback:function(t){e.showAddModal=t},expression:"showAddModal"}},[t("div",{staticClass:"add-record-modal"},[e._l(e.seccionActual.columnas,(function(a){return t("div",{key:a.nombre,staticClass:"form-group"},[t("label",{staticClass:"form-label",attrs:{for:"modal-"+a.nombre}},[e._v("\n          "+e._s(a.nombre.charAt(0).toUpperCase()+a.nombre.slice(1))+"\n        ")]),"texto"===a.tipo||"email"===a.tipo?t("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevaFila.valores[a.nombre],expression:"nuevaFila.valores[columna.nombre]"}],staticClass:"form-control",attrs:{id:"modal-"+a.nombre,type:"text",placeholder:"Ingrese "+a.nombre},domProps:{value:e.nuevaFila.valores[a.nombre]},on:{input:function(t){t.target.composing||e.$set(e.nuevaFila.valores,a.nombre,t.target.value)}}}):"relacional"===a.tipo?t("div",{staticClass:"search-select-container"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevaFila.valores[a.nombre],expression:"nuevaFila.valores[columna.nombre]"}],staticClass:"form-control",attrs:{id:"modal-"+a.nombre,type:"text",placeholder:"Buscar en "+a.seccionRelacionada,autocomplete:"off"},domProps:{value:e.nuevaFila.valores[a.nombre]},on:{input:[function(t){t.target.composing||e.$set(e.nuevaFila.valores,a.nombre,t.target.value)},function(t){return e.filtrarOpcionesNuevaFila(t,a)}],focus:function(t){return e.mostrarOpcionesNueva(a)},blur:function(t){return e.ocultarOpcionesNueva(a)}}}),e.opcionesVisibles[a.nombre+"_nueva"]?t("div",{staticClass:"opciones-dropdown"},[e._l(e.opcionesFiltradas[a.nombre+"_nueva"],(function(o){return t("div",{key:o,staticClass:"opcion-item",on:{mousedown:function(t){return t.preventDefault(),e.seleccionarOpcionNuevaFila(o,a.nombre)}}},[e._v("\n              "+e._s(o)+"\n            ")])})),0===e.opcionesFiltradas[a.nombre+"_nueva"].length?t("div",{staticClass:"no-opciones"},[e._v("\n              No se encontraron resultados\n            ")]):e._e()],2):e._e()]):"fecha"===a.tipo?t("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevaFila.valores[a.nombre],expression:"nuevaFila.valores[columna.nombre]"}],staticClass:"form-control",attrs:{id:"modal-"+a.nombre,type:"date"},domProps:{value:e.nuevaFila.valores[a.nombre]},on:{input:function(t){t.target.composing||e.$set(e.nuevaFila.valores,a.nombre,t.target.value)}}}):"telefono"===a.tipo?t("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevaFila.valores[a.nombre],expression:"nuevaFila.valores[columna.nombre]"}],staticClass:"form-control",attrs:{id:"modal-"+a.nombre,type:"tel",placeholder:"Ingrese "+a.nombre},domProps:{value:e.nuevaFila.valores[a.nombre]},on:{input:function(t){t.target.composing||e.$set(e.nuevaFila.valores,a.nombre,t.target.value)}}}):"correo"===a.tipo?t("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevaFila.valores[a.nombre],expression:"nuevaFila.valores[columna.nombre]"}],staticClass:"form-control",attrs:{id:"modal-"+a.nombre,type:"email",placeholder:"Ingrese "+a.nombre},domProps:{value:e.nuevaFila.valores[a.nombre]},on:{input:function(t){t.target.composing||e.$set(e.nuevaFila.valores,a.nombre,t.target.value)}}}):"enlace"===a.tipo?t("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevaFila.valores[a.nombre],expression:"nuevaFila.valores[columna.nombre]"}],staticClass:"form-control",attrs:{id:"modal-"+a.nombre,type:"url",placeholder:"Ingrese "+a.nombre},domProps:{value:e.nuevaFila.valores[a.nombre]},on:{input:function(t){t.target.composing||e.$set(e.nuevaFila.valores,a.nombre,t.target.value)}}}):"textarea"===a.tipo?t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.nuevaFila.valores[a.nombre],expression:"nuevaFila.valores[columna.nombre]"}],staticClass:"form-control",staticStyle:{resize:"vertical","min-height":"80px"},attrs:{id:"modal-"+a.nombre,placeholder:"Ingrese "+a.nombre,rows:"4"},domProps:{value:e.nuevaFila.valores[a.nombre]},on:{input:function(t){t.target.composing||e.$set(e.nuevaFila.valores,a.nombre,t.target.value)}}}):"select"===a.tipo?t("select",{directives:[{name:"model",rawName:"v-model",value:e.nuevaFila.valores[a.nombre],expression:"nuevaFila.valores[columna.nombre]"}],staticClass:"form-control",attrs:{id:"modal-"+a.nombre},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.nuevaFila.valores,a.nombre,t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Selecciona una opción")]),e._l(a.opciones,(function(a){return t("option",{key:a,domProps:{value:a}},[e._v("\n            "+e._s(a)+"\n          ")])}))],2):"numero"===a.tipo?t("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevaFila.valores[a.nombre],expression:"nuevaFila.valores[columna.nombre]"}],staticClass:"form-control",attrs:{id:"modal-"+a.nombre,type:"number",placeholder:"Ingrese "+a.nombre},domProps:{value:e.nuevaFila.valores[a.nombre]},on:{input:function(t){t.target.composing||e.$set(e.nuevaFila.valores,a.nombre,t.target.value)}}}):"archivo"===a.tipo?t("div",{staticClass:"file-upload-container"},[t("FileUpload",{key:"modal-file-upload-"+a.nombre,attrs:{"case-id":e.seccionActual._id||e.seccionActual.id,"case-name":e.seccionActual.nombre},on:{"files-uploaded":e.onFilesUploaded},model:{value:e.nuevaFila.valores[a.nombre],callback:function(t){e.$set(e.nuevaFila.valores,a.nombre,t)},expression:"nuevaFila.valores[columna.nombre]"}})],1):e._e()])})),t("div",{staticClass:"modal-actions"},[t("button",{staticClass:"btn-modal-primary",on:{click:e.agregarFilaDesdeModal}},[t("i",{staticClass:"ti-plus"}),e._v(" Agregar Registro\n        ")]),t("button",{staticClass:"btn-modal-secondary",on:{click:function(t){e.showAddModal=!1}}},[t("i",{staticClass:"ti-close"}),e._v(" Cancelar\n        ")])])],2)])],1)},r=[],n=a("2b0e"),i=a("b9d1"),s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"calendar-container"},[t("div",{staticClass:"calendar-header"},[t("div",{staticClass:"calendar-controls"},[t("button",{staticClass:"btn-nav",on:{click:e.previousMonth}},[t("i",{staticClass:"ti-angle-left"})]),t("h3",{staticClass:"current-month"},[e._v(e._s(e.currentMonthYear))]),t("button",{staticClass:"btn-nav",on:{click:e.nextMonth}},[t("i",{staticClass:"ti-angle-right"})])]),t("div",{staticClass:"calendar-actions"},[t("button",{staticClass:"btn-today",on:{click:e.goToToday}},[t("i",{staticClass:"ti-calendar"}),e._v(" Hoy\n      ")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedView,expression:"selectedView"}],staticClass:"view-selector",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedView=t.target.multiple?a:a[0]}}},[t("option",{attrs:{value:"month"}},[e._v("Mes")]),t("option",{attrs:{value:"week"}},[e._v("Semana")])])])]),"month"===e.selectedView?t("div",{staticClass:"calendar-grid"},[e.loading?t("div",{staticClass:"calendar-loading"},[t("div",{staticClass:"loading-spinner"}),t("p",[e._v("Cargando eventos...")])]):e._e(),t("div",{staticClass:"calendar-weekdays"},e._l(e.weekDays,(function(a){return t("div",{key:a,staticClass:"weekday"},[e._v("\n        "+e._s(a)+"\n      ")])})),0),t("div",{staticClass:"calendar-days"},e._l(e.calendarDays,(function(a){return t("div",{key:a.date,staticClass:"calendar-day",class:{"other-month":!a.isCurrentMonth,today:a.isToday,"has-events":a.events.length>0},on:{click:function(t){return e.selectDay(a)}}},[t("div",{staticClass:"day-number"},[e._v(e._s(a.dayNumber))]),t("div",{staticClass:"day-events"},[e._l(a.events.slice(0,2),(function(a,o){return t("div",{key:`event-${o}-${a.id||"no-id"}`,staticClass:"event-item",style:{backgroundColor:e.getEventColor(a)},attrs:{title:a.title},on:{click:function(t){return t.stopPropagation(),e.showEventDetails(a)}}},[t("div",{staticClass:"event-title"},[e._v(e._s(e.getEventTitle(a)))]),e.getEventSubtitle(a)?t("div",{staticClass:"event-subtitle"},[e._v(e._s(e.getEventSubtitle(a)))]):e._e()])})),a.events.length>2?t("div",{staticClass:"more-events"},[e._v("\n            +"+e._s(a.events.length-2)+" más\n          ")]):e._e()],2)])})),0)]):t("div",{staticClass:"week-view"},[t("div",{staticClass:"week-header"},e._l(e.weekDays,(function(a){return t("div",{key:a,staticClass:"weekday-header"},[e._v("\n        "+e._s(a)+"\n      ")])})),0),t("div",{staticClass:"week-grid"},e._l(e.weekDays,(function(a){return t("div",{key:a,staticClass:"week-day",class:{today:e.isToday(a)}},[t("div",{staticClass:"week-day-number"},[e._v(e._s(e.getDayNumber(a)))]),t("div",{staticClass:"week-day-events"},e._l(e.getWeekDayEvents(a),(function(a,o){return t("div",{key:`week-event-${o}-${a.id||"no-id"}`,staticClass:"week-event",style:{backgroundColor:e.getEventColor(a)},on:{click:function(t){return e.showEventDetails(a)}}},[t("div",{staticClass:"event-title"},[e._v(e._s(a.title))]),t("div",{staticClass:"event-time"},[e._v(e._s(e.formatTime(a.date)))])])})),0)])})),0)]),t("b-modal",{attrs:{title:"Detalles del Registro",size:"lg","hide-footer":""},model:{value:e.showEventModal,callback:function(t){e.showEventModal=t},expression:"showEventModal"}},[e.selectedEvent?t("div",{staticClass:"event-details"},[t("div",{staticClass:"event-fields"},[e.getRegistroValues(e.selectedEvent)?t("div",{staticClass:"field-section"},e._l(e.getRegistroValues(e.selectedEvent),(function(a,o){return t("div",{key:"valor-"+o,staticClass:"event-field"},[t("label",{staticClass:"field-label"},[e._v(e._s(e.formatFieldName(o))+":")]),t("span",{staticClass:"field-value"},[e._v(e._s(a))])])})),0):e._e()]),t("div",{staticClass:"event-actions"},[t("button",{staticClass:"btn-edit",on:{click:function(t){return e.editEvent(e.selectedEvent)}}},[t("i",{staticClass:"ti-pencil"}),e._v(" Editar\n        ")]),t("button",{staticClass:"btn-delete",on:{click:function(t){return e.deleteEvent(e.selectedEvent)}}},[t("i",{staticClass:"ti-trash"}),e._v(" Eliminar\n        ")])])]):e._e()]),t("b-modal",{attrs:{title:e.editingEvent?"Editar Evento":"Nuevo Evento",size:"lg","hide-footer":""},model:{value:e.showEventForm,callback:function(t){e.showEventForm=t},expression:"showEventForm"}},[t("div",{staticClass:"event-form"},[t("div",{staticClass:"form-group"},[t("label",[e._v("Título del evento")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.eventForm.title,expression:"eventForm.title"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Ingrese el título del evento"},domProps:{value:e.eventForm.title},on:{input:function(t){t.target.composing||e.$set(e.eventForm,"title",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[e._v("Fecha")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.eventForm.date,expression:"eventForm.date"}],staticClass:"form-control",attrs:{type:"date"},domProps:{value:e.eventForm.date},on:{input:function(t){t.target.composing||e.$set(e.eventForm,"date",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[e._v("Hora")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.eventForm.time,expression:"eventForm.time"}],staticClass:"form-control",attrs:{type:"time"},domProps:{value:e.eventForm.time},on:{input:function(t){t.target.composing||e.$set(e.eventForm,"time",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[e._v("Color")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.eventForm.color,expression:"eventForm.color"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.eventForm,"color",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:"#007bff"}},[e._v("Azul")]),t("option",{attrs:{value:"#28a745"}},[e._v("Verde")]),t("option",{attrs:{value:"#ffc107"}},[e._v("Amarillo")]),t("option",{attrs:{value:"#dc3545"}},[e._v("Rojo")]),t("option",{attrs:{value:"#6f42c1"}},[e._v("Púrpura")]),t("option",{attrs:{value:"#fd7e14"}},[e._v("Naranja")])])]),t("div",{staticClass:"form-group"},[t("label",[e._v("Datos adicionales")]),e._l(e.availableFields,(function(a,o){return t("div",{key:"field-"+o,staticClass:"field-input"},[t("label",[e._v(e._s(e.formatFieldName(o)))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.eventForm.data[o],expression:"eventForm.data[key]"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Ingrese "+e.formatFieldName(o)},domProps:{value:e.eventForm.data[o]},on:{input:function(t){t.target.composing||e.$set(e.eventForm.data,o,t.target.value)}}})])}))],2),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-save",on:{click:e.saveEvent}},[t("i",{staticClass:"ti-save"}),e._v(" "+e._s(e.editingEvent?"Actualizar":"Guardar")+"\n        ")]),t("button",{staticClass:"btn-cancel",on:{click:e.cancelEventForm}},[t("i",{staticClass:"ti-close"}),e._v(" Cancelar\n        ")])])])])],1)},l=[],c={name:"CalendarView",props:{events:{type:Array,default:()=>[]},dateField:{type:String,required:!0},titleField:{type:String,required:!0},availableFields:{type:[Object,Array],default:()=>({})},columns:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},data(){return{currentDate:new Date,selectedView:"month",showEventModal:!1,showEventForm:!1,selectedEvent:null,editingEvent:null,eventForm:{title:"",date:"",time:"",color:"#007bff",data:{}},weekDays:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"]}},computed:{currentMonthYear(){return this.currentDate.toLocaleDateString("es-ES",{month:"long",year:"numeric"})},calendarDays(){const e=this.currentDate.getFullYear(),t=this.currentDate.getMonth(),a=new Date(e,t,1),o=(new Date(e,t+1,0),new Date(a));o.setDate(o.getDate()-a.getDay());const r=[],n=new Date;for(let i=0;i<42;i++){const e=new Date(o);e.setDate(o.getDate()+i);const a=this.getEventsForDate(e);r.push({date:e,dayNumber:e.getDate(),isCurrentMonth:e.getMonth()===t,isToday:this.isSameDate(e,n),events:a})}return r}},methods:{previousMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()-1,1),this.$emit("month-changed",this.currentDate.getFullYear(),this.currentDate.getMonth()+1)},nextMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()+1,1),this.$emit("month-changed",this.currentDate.getFullYear(),this.currentDate.getMonth()+1)},goToToday(){this.currentDate=new Date},selectDay(e){this.eventForm.date=this.formatDateForInput(e.date),this.eventForm.time="",this.eventForm.title="",this.eventForm.data={},this.editingEvent=null,this.showEventForm=!0},getEventsForDate(e){console.log("🔍 Buscando eventos para fecha:",e.toDateString()),console.log("📅 Eventos disponibles:",this.events.length);const t=this.events.filter(t=>{const a=new Date(t.date),o=this.isSameDate(a,e);return console.log(`Evento "${t.title}" en ${t.date} - Mismo día: ${o}`),o});return console.log(`✅ Eventos encontrados para ${e.toDateString()}:`,t.length),t},isSameDate(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},isToday(e){const t=new Date;return this.isSameDate(e,t)},getEventColor(e){return e.color||"#007bff"},getEventTitle(e){const t=e.title||"",a=t.indexOf(" (");return a>0?t.substring(0,a):t},getEventSubtitle(e){const t=e.title||"",a=t.indexOf(" ("),o=t.lastIndexOf(")");return a>0&&o>a?t.substring(a+2,o):""},showEventDetails(e){console.log("🎯 showEventDetails - Event:",e),this.selectedEvent=e,this.showEventModal=!0},editEvent(e){this.editingEvent=e,this.eventForm={title:e.title||"",date:this.formatDateForInput(new Date(e.date)),time:this.formatTimeForInput(new Date(e.date)),color:e.color||"#007bff",data:{...e.data}},this.showEventModal=!1,this.showEventForm=!0},deleteEvent(e){confirm("¿Estás seguro de que quieres eliminar este evento?")&&(this.$emit("delete-event",e),this.showEventModal=!1)},saveEvent(){if(!this.eventForm.title||!this.eventForm.date)return void alert("Por favor completa los campos requeridos");const e={title:this.eventForm.title,date:this.combineDateTime(this.eventForm.date,this.eventForm.time),color:this.eventForm.color,data:this.eventForm.data};this.editingEvent?this.$emit("update-event",{...this.editingEvent,...e}):this.$emit("add-event",e),this.cancelEventForm()},cancelEventForm(){this.showEventForm=!1,this.editingEvent=null,this.eventForm={title:"",date:"",time:"",color:"#007bff",data:{}}},formatDateForInput(e){return e.toISOString().split("T")[0]},formatTimeForInput(e){return e.toTimeString().slice(0,5)},combineDateTime(e,t){const a=new Date(e+"T"+(t||"00:00"));return a.toISOString()},formatFullDate(e){const t=new Date(e);return t.toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})},formatTime(e){const t=new Date(e);return t.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})},formatFieldName(e){return e.charAt(0).toUpperCase()+e.slice(1).replace(/([A-Z])/g," $1")},formatFieldValue(e,t){return null===e||void 0===e?"-":"createdAt"===t||"updatedAt"===t?new Date(e).toLocaleString("es-ES"):"object"===typeof e&&null!==e?"valores"===t?Object.entries(e).map(([e,t])=>`${e}: ${t}`).join(", "):JSON.stringify(e,null,2):"boolean"===typeof e?e?"Sí":"No":"number"===typeof e?e.toLocaleString("es-ES"):String(e)},getRegistroValues(e){console.log("🔍 getRegistroValues - Event:",e);let t=null;if(e&&e.registro?t=e.registro:e&&e.data&&e.data.registro&&(t=e.data.registro),!t)return console.log("❌ No hay registro:",{event:e,registro:t}),{};console.log("📊 Registro encontrado:",t);let a=null;if(t.registro&&(a=t.registro,console.log("✅ Encontrado registro anidado")),!a||!a.valores)return console.log("❌ No hay registro anidado o valores:",{registro:t,registroAnidado:a}),{};const o=a.valores;return console.log("📊 Valores del registro anidado:",o),o},getRegistroData(e){console.log("🔍 getRegistroData - Event:",e);let t=null;if(e&&e.registro?t=e.registro:e&&e.data&&e.data.registro&&(t=e.data.registro),!t)return console.log("❌ No hay registro:",{event:e,registro:t}),{};console.log("📊 Registro encontrado:",t);let a=null;if(t.registro&&(a=t.registro,console.log("✅ Encontrado registro anidado para metadata")),!a)return console.log("❌ No hay registro anidado"),{};const o={};return Object.entries(a).forEach(([e,t])=>{"valores"!==e&&null!==t&&void 0!==t&&(o[e]=t)}),console.log("✅ Datos del registro:",o),o},getRelevantEventFields(e){if(!e||!e.registro)return{};const t=e.registro,a={};return t._id&&(a["ID"]=t._id),t.seccionId&&(a["ID Sección"]=t.seccionId),void 0!==t.__v&&(a["Versión"]=t.__v),t.createdAt&&(a["Fecha Creación"]=t.createdAt),t.updatedAt&&(a["Fecha Actualización"]=t.updatedAt),t.valores&&"object"===typeof t.valores&&Object.entries(t.valores).forEach(([e,t])=>{null!==t&&void 0!==t&&""!==t&&(a[e]=t)}),a},getWeekDayEvents(e){return[]},getDayNumber(e){return""}}},u=c,d=(a("6bf6"),a("2877")),p=Object(d["a"])(u,s,l,!1,null,"4c03cbf5",null),v=p.exports,m=a("fa4a");function g(){const e=async(e,t,a)=>{try{const o=await i["g"].updateRegistroArchivos(e,t,a);return o}catch(o){throw console.error("Error guardando archivos:",o),o}},t=async(e,t)=>{try{const a=await i["g"].getRegistro(e,t);return a}catch(a){throw console.error("Error cargando archivos:",a),a}},a=async(e,t,a,o)=>{try{const r={valores:{[a]:o}};await i["g"].updateRegistro(e,t,r),console.log("✅ Archivos sincronizados con el backend")}catch(r){throw console.error("❌ Error sincronizando archivos:",r),r}},o=e=>e&&Array.isArray(e)?e.map(e=>({id:e.id,nombre:e.name,"tamaño":e.size,tipo:e.mimeType,url:e.webViewLink,subidoPor:e.uploadedBy,fechaSubida:e.uploadedAt})):[],r=e=>{if(0===e)return"0 Bytes";const t=1024,a=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,o)).toFixed(2))+" "+a[o]};return{guardarArchivosRegistro:e,cargarArchivosRegistro:t,sincronizarArchivos:a,obtenerInfoArchivos:o,"formatearTamañoArchivo":r}}var f=a("3445"),b=function(){var e=this,t=e._self._c;return t("div",{staticClass:"file-upload-component"},[e.isAuthenticated?t("div",{staticClass:"upload-section"},[t("div",{staticClass:"drop-zone",class:{dragover:e.isDragging,uploading:e.uploading},on:{drop:e.handleDrop,dragover:function(t){t.preventDefault(),e.isDragging=!0},dragleave:function(t){t.preventDefault(),e.isDragging=!1},click:e.triggerFileInput}},[e.uploading?e._e():t("div",{staticClass:"drop-content"},[t("i",{staticClass:"ti-cloud-upload"}),t("h4",[e._v("Subir archivo a Google Drive")]),t("p",[e._v("Arrastra archivos aquí o haz clic para seleccionar")]),t("small",[e._v("Máximo 10MB por archivo")])]),e.uploading?t("div",{staticClass:"upload-progress"},[t("div",{staticClass:"progress-info"},[t("span",{staticClass:"filename"},[e._v(e._s(e.currentFile&&e.currentFile.name))]),t("span",{staticClass:"progress-text"},[e._v(e._s(e.uploadProgress)+"%")])]),t("div",{staticClass:"progress-bar"},[t("div",{staticClass:"progress-fill",style:{width:e.uploadProgress+"%"}})])]):e._e()]),t("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",multiple:"",accept:"*/*"},on:{change:e.handleFileSelect}}),e.uploadedFiles.length>0?t("div",{staticClass:"uploaded-files"},[t("h5",[e._v("Archivos subidos:")]),t("div",{staticClass:"file-list"},e._l(e.uploadedFiles,(function(a){return t("div",{key:a.id,staticClass:"file-item"},[t("div",{staticClass:"file-info"},[t("i",{staticClass:"ti-file"}),t("span",{staticClass:"file-name"},[e._v(e._s(a.name))]),t("span",{staticClass:"file-size"},[e._v(e._s(e.formatFileSize(a.size)))])]),t("div",{staticClass:"file-actions"},[t("button",{staticClass:"btn-view",attrs:{title:"Ver en Google Drive"},on:{click:function(t){return e.viewFile(a)}}},[t("i",{staticClass:"ti-eye"})]),t("button",{staticClass:"btn-download",attrs:{title:"Descargar"},on:{click:function(t){return e.downloadFile(a.id)}}},[t("i",{staticClass:"ti-download"})]),t("button",{staticClass:"btn-delete",attrs:{title:"Eliminar"},on:{click:function(t){return e.deleteFile(a.id)}}},[t("i",{staticClass:"ti-trash"})])])])})),0)]):e._e()]):t("div",{staticClass:"auth-section"},[e._m(0),t("button",{staticClass:"btn-google-auth",on:{click:e.connectGoogleDrive}},[t("i",{staticClass:"ti-google"}),e._v("\n      Conectar Google Drive\n    ")]),t("button",{staticClass:"btn-google-auth-secondary",on:{click:e.useBasicMode}},[t("i",{staticClass:"ti-upload"}),e._v("\n      Modo Básico (Sin OAuth)\n    ")]),e._m(1)])])},h=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"auth-message"},[t("i",{staticClass:"ti-cloud"}),t("span",[e._v("Conecta tu Google Drive para subir archivos")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"auth-note"},[t("small",[t("i",{staticClass:"ti-info"}),e._v("\n        Si tienes problemas con OAuth, puedes usar el modo básico temporalmente.\n      ")])])}],y=a("4b04");const _="478457945260-8bdlt0vbb8ugvhkj8go05e59cu7evnqj.apps.googleusercontent.com",C="AIzaSyBbNnycTLwGFPsIf38JuYl7-x80lRFElcE",w="https://www.googleapis.com/auth/drive.file";let A=!1;const F=()=>A?Promise.resolve(y["a"].auth2.getAuthInstance()):new Promise((e,t)=>{y["a"].load("client:auth2",()=>{y["a"].client.init({apiKey:C,clientId:_,discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scope:w,ux_mode:"redirect",redirect_uri:window.location.origin}).then(()=>{A=!0;const t=y["a"].auth2.getAuthInstance();e(t)}).catch(e=>{console.error("Error inicializando Google API:",e),t(e)})})}),x=()=>A?Promise.resolve():new Promise((e,t)=>{try{y["a"].load("client",()=>{y["a"].client.init({apiKey:C,discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]}).then(()=>{A=!0,e()}).catch(t)})}catch(a){t(new Error("No se pudo inicializar Google API: "+a.message))}}),E=async()=>{try{const e=await F();return e.isSignedIn.get()}catch(e){return console.warn("OAuth no disponible, usando API Key solo:",e),!1}},S=async()=>{try{const e=await F();if(!e.isSignedIn.get()){const t=await e.signIn({prompt:"select_account",ux_mode:"redirect"});return t}return e.currentUser.get()}catch(e){if(console.error("Error en OAuth:",e),"server_error"===e.error)throw new Error("Error del servidor de Google. Intenta de nuevo en unos minutos.");if("access_denied"===e.error)throw new Error("Acceso denegado. Verifica que tu email esté autorizado.");if("popup_closed_by_user"===e.error)throw new Error("Ventana de autenticación cerrada.");if("popup_blocked_by_browser"===e.error)throw new Error("El navegador bloqueó la ventana emergente. Permite popups para este sitio.");throw e}},k=()=>{const e=`https://accounts.google.com/o/oauth2/auth?client_id=${_}&redirect_uri=${encodeURIComponent(window.location.origin)}&scope=${encodeURIComponent(w)}&response_type=token&prompt=select_account`;window.location.href=e},O=async(e,t={})=>{await S();const a={name:e.name,mimeType:e.type,...t};t.folderId&&(a.parents=[t.folderId]);const o=new FormData;o.append("metadata",new Blob([JSON.stringify(a)],{type:"application/json"})),o.append("file",e);try{const e=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:new Headers({Authorization:"Bearer "+y["a"].auth.getToken().access_token}),body:o});if(!e.ok)throw new Error(`Upload failed: ${e.status} ${e.statusText}`);const a=await e.json();return{...a,uploadedBy:y["a"].auth2.getAuthInstance().currentUser.get().getBasicProfile().getEmail(),uploadedAt:(new Date).toISOString(),caseId:t.caseId}}catch(r){throw console.error("Error uploading file:",r),r}},j=async e=>{await S();try{const t=await y["a"].client.drive.files.get({fileId:e,alt:"media"});return t.body}catch(t){throw console.error("Error downloading file:",t),t}},N=async e=>{await S();try{return await y["a"].client.drive.files.delete({fileId:e}),{success:!0,message:"File deleted successfully"}}catch(t){throw console.error("Error deleting file:",t),t}};var D={name:"FileUpload",props:{caseId:{type:String,default:null},caseName:{type:String,default:""},folderId:{type:String,default:null},value:{type:Array,default:()=>[]}},data(){return{isAuthenticated:!1,uploading:!1,uploadProgress:0,currentFile:null,isDragging:!1,uploadedFiles:[]}},computed:{filesValue:{get(){return this.value},set(e){this.$emit("update:value",e)}}},mounted(){this.initializeAuth()},methods:{async initializeAuth(){try{const e=await E();this.isAuthenticated=e,e&&await this.loadUploadedFiles()}catch(e){console.error("Error checking auth:",e)}},async connectGoogleDrive(){try{await S(),this.isAuthenticated=!0,await this.loadUploadedFiles()}catch(e){console.error("Error connecting to Google Drive:",e),"server_error"===e.error?alert("Error del servidor de Google. Intenta de nuevo en unos minutos."):"popup_blocked_by_browser"===e.error?confirm("El navegador bloqueó la ventana emergente. ¿Quieres usar redirección directa?")&&k():"access_denied"===e.error||"popup_closed_by_user"===e.error?alert("Error de acceso: La aplicación no está configurada correctamente en Google Cloud Console. Verifica que tu email esté agregado como usuario de prueba."):e.message&&e.message.includes("403")?alert("Error 403: Tu email no está autorizado. Verifica que tu email esté agregado como usuario de prueba en Google Cloud Console."):e.message&&e.message.includes("server_error")?alert("Error del servidor de Google. Intenta de nuevo en unos minutos."):alert("Error al conectar con Google Drive: "+(e.message||e.error||"Error desconocido"))}},async useBasicMode(){try{await x(),this.isAuthenticated=!0,alert("Modo básico activado. Algunas funciones pueden estar limitadas.")}catch(e){console.error("Error en modo básico:",e),alert("Error activando modo básico: "+e.message)}},async loadUploadedFiles(){this.uploadedFiles=[...this.filesValue]},triggerFileInput(){!this.uploading&&this.$refs.fileInput&&this.$refs.fileInput.click()},handleFileSelect(e){const t=Array.from(e.target.files);this.uploadFiles(t)},handleDrop(e){this.isDragging=!1;const t=Array.from(e.dataTransfer.files);this.uploadFiles(t)},async uploadFiles(e){if(0!==e.length)for(const t of e)t.size>10485760?alert(`El archivo ${t.name} es demasiado grande. Máximo 10MB.`):await this.uploadSingleFile(t)},async uploadSingleFile(e){this.uploading=!0,this.currentFile=e,this.uploadProgress=0;try{const t={caseId:this.caseId,caseName:this.caseName,folderId:this.folderId},a=setInterval(()=>{this.uploadProgress<90&&(this.uploadProgress+=10*Math.random())},200),o=await O(e,t);clearInterval(a),this.uploadProgress=100;const r={id:o.id,name:e.name,size:e.size,mimeType:e.type,webViewLink:o.webViewLink,uploadedAt:o.uploadedAt,uploadedBy:o.uploadedBy};this.uploadedFiles.push(r),this.filesValue=[...this.uploadedFiles],this.$emit("files-uploaded",r),this.$emit("archivos-actualizados",this.uploadedFiles),setTimeout(()=>{this.uploading=!1,this.uploadProgress=0,this.currentFile=null},500)}catch(t){console.error("Error uploading file:",t),this.uploading=!1,this.uploadProgress=0,this.currentFile=null,alert(`Error al subir ${e.name}: ${t.message}`)}},viewFile(e){e.webViewLink&&window.open(e.webViewLink,"_blank")},async downloadFile(e){try{const t=await j(e),a=window.URL.createObjectURL(t),o=document.createElement("a");o.href=a;const r=this.uploadedFiles.find(t=>t.id===e);o.download=r?r.name:"file",document.body.appendChild(o),o.click(),o.remove(),window.URL.revokeObjectURL(a)}catch(t){console.error("Error downloading file:",t),alert("Error al descargar el archivo")}},async deleteFile(e){if(confirm("¿Estás seguro de que quieres eliminar este archivo?"))try{await N(e),this.uploadedFiles=this.uploadedFiles.filter(t=>t.id!==e),this.filesValue=[...this.uploadedFiles],this.$emit("archivos-actualizados",this.uploadedFiles)}catch(t){console.error("Error deleting file:",t),alert("Error al eliminar el archivo")}},formatFileSize(e){if(0===e)return"0 Bytes";const t=1024,a=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,o)).toFixed(2))+" "+a[o]}}},P=D,I=(a("ac6c"),Object(d["a"])(P,b,h,!1,null,"2cb7b1b4",null)),T=I.exports,M={name:"CrmSeccion",components:{CalendarView:v,FiltrosDinamicos:f["a"],FileUpload:T},props:{sectionName:{type:String,required:!0}},setup(e){const t=Object(n["ref"])([]),a=Object(n["reactive"])({nombre:"",tipo:"texto",seccionRelacionada:"",campoMostrar:"",opcionesSelect:""}),o=Object(n["reactive"])({valores:{}}),r=Object(n["ref"])(!1),s=Object(n["ref"])(!1),l=Object(n["ref"])(!1),c=Object(n["ref"])(!1),u=Object(n["ref"])(null),d=Object(n["ref"])(null),p=Object(n["ref"])(""),v=Object(n["ref"])(!0),f=Object(n["ref"])(0),b=Object(n["ref"])("table"),h=Object(n["ref"])(""),y=Object(n["ref"])(""),_=Object(n["ref"])(""),C=Object(n["ref"])(!1),w=Object(n["ref"])(!1),A=Object(n["ref"])(!1),F=Object(n["ref"])("#007bff"),x=Object(n["ref"])(new Date),E=Object(n["ref"])([]),S=Object(n["ref"])([]),k=(Object(n["ref"])(null),Object(n["ref"])(null)),O=Object(n["ref"])([]),j=Object(n["ref"])(""),N=Object(n["reactive"])({}),D=Object(n["reactive"])({}),P=Object(n["reactive"])({}),I=(Object(n["reactive"])({}),Object(n["ref"])(null)),{registros:T,pagination:M,filters:R,loading:z,cargarRegistros:$}=Object(m["a"])(),{sincronizarArchivos:L,obtenerInfoArchivos:B,"formatearTamañoArchivo":U}=g(),V=Object(n["ref"])(!0),q=Object(n["ref"])(!1),K=Object(n["ref"])({}),G=Object(n["computed"])(()=>{console.log("Secciones:",t.value.map(e=>e.nombre)),console.log("SectionName:",e.sectionName);const a=(e.sectionName||"").replace(/-/g," ").trim().toLowerCase(),o=t.value.find(e=>(e.nombre||"").trim().toLowerCase()===a);return console.log("Sección encontrada:",o),o}),H=Object(n["computed"])(()=>G.value?t.value.filter(e=>e.nombre!==G.value.nombre):[]),Q=Object(n["computed"])(()=>{if(!a.seccionRelacionada)return[];const e=t.value.find(e=>e.nombre===a.seccionRelacionada);return e&&e.columnas?e.columnas.map(e=>"string"===typeof e?e:e.nombre):[]}),Y=Object(n["computed"])(()=>!(!a.nombre||!a.nombre.trim())&&("relacional"===a.tipo?a.seccionRelacionada&&a.campoMostrar:"select"!==a.tipo||a.opcionesSelect&&a.opcionesSelect.trim())),Z=Object(n["computed"])(()=>!(!G.value||!G.value.columnas)&&G.value.columnas.some(e=>{const t="string"===typeof e?{nombre:e,tipo:"texto"}:e;return"fecha"===t.tipo})),W=Object(n["computed"])(()=>S.value&&S.value.length>0),J=(e,t)=>(V.value,e.valores&&void 0!==e.valores[t]?e.valores[t]:e[t]||""),X=(e,t,a)=>{V.value?(e.valores||(e.valores={}),e.valores[t]=a):e.valores?e.valores[t]=a:e[t]=a},ee=Object(n["computed"])(()=>G.value&&G.value.columnas?G.value.columnas.filter(e=>{const t="string"===typeof e?{nombre:e,tipo:"texto"}:e;return"fecha"===t.tipo}).map(e=>"string"===typeof e?{nombre:e}:e):[]),te=Object(n["computed"])(()=>G.value&&G.value.columnas?G.value.columnas.filter(e=>{const t="string"===typeof e?{nombre:e,tipo:"texto"}:e;return"texto"===t.tipo}).map(e=>"string"===typeof e?{nombre:e}:e):[]),ae=Object(n["computed"])(()=>G.value&&G.value.columnas?G.value.columnas.filter(e=>{const t="string"===typeof e?{nombre:e,tipo:"texto"}:e;return"select"===t.tipo&&t.opciones&&t.opciones.length>0}).map(e=>"string"===typeof e?{nombre:e}:e):[]),oe=Object(n["computed"])(()=>j.value&&G.value&&G.value.columnas?G.value.columnas.find(e=>{const t="string"===typeof e?{nombre:e,tipo:"texto"}:e;return t.nombre===j.value&&"select"===t.tipo}):null),re=Object(n["computed"])(()=>{if(console.log("=== DEBUG CALENDAR ==="),console.log("Calendario habilitado:",C.value),console.log("Campo fecha:",h.value),console.log("Campo título:",y.value),console.log("Datos del calendario:",O.value.length),!C.value||!O.value||0===O.value.length)return console.log("❌ No se pueden generar eventos"),[];const e=O.value.map(e=>{console.log("Procesando registro:",e),console.log("Campos disponibles:",Object.keys(e)),console.log("Campos seleccionados para mostrar:",E.value);const t=e.valores&&"object"===typeof e.valores,a=e.title&&e.date&&e.id;let o,r,n,i;if(t){if(o=e.valores[y.value]||"Sin título",r=e.valores[h.value],n=e.valores.color||F.value,i=e.valores,E.value.length>0){const t=E.value.map(t=>e.valores[t]).filter(e=>e&&""!==e.trim()).join(" - ");t&&(o=`${o} (${t})`)}}else{if(!a)return console.warn("Estructura de registro no reconocida:",e),null;if(o=e[y.value]||e.title||"Sin título",r=e[h.value]||e.date,n=e.color||F.value,i=e,E.value.length>0){const t=E.value.map(t=>{const a=e[t];return console.log(`Campo ${t}:`,a),a}).filter(e=>e&&""!==e.toString().trim()).join(" - ");t&&(o=`${o} (${t})`)}}let s=n;if(j.value&&N&&Object.keys(N).length>0){const e=i[j.value];e&&N[e]&&(s=N[e])}const l={id:e._id||e.id,title:o,date:r,color:s,data:i,registro:e};return console.log("Evento generado:",l),l}).filter(e=>e&&e.date);return console.log("✅ Eventos generados:",e.length),e}),ne=Object(n["computed"])(()=>G.value&&G.value.columnas?G.value.columnas.map(e=>{const t="string"===typeof e?{nombre:e,tipo:"texto"}:e;return t.nombre}).filter(e=>e!==h.value&&e!==y.value):[]),ie=async()=>{v.value=!0;try{const a=await i["g"].getAll();t.value=Array.isArray(a)?a:a.data||[];for(const o of t.value)try{const e=await i["g"].getRegistros(o._id||o.id);o.datos=Array.isArray(e)?e:[],console.log(`📊 Datos cargados para ${o.nombre}:`,o.datos.length,"registros")}catch(e){console.warn(`⚠️ Error cargando datos para ${o.nombre}:`,e),o.datos=[]}ve(),G.value&&await se()}catch(a){alert("Error al cargar secciones"),t.value=[]}v.value=!1},se=async()=>{if(G.value)try{const e=M.value&&M.value.currentPage?M.value.currentPage:1,t=R.value&&R.value.applied?R.value.applied:{};console.log("🔄 Cargando registros paginados:",{seccionId:G.value._id||G.value.id,page:e,filters:t}),await $(G.value._id||G.value.id,{page:e,limit:10,filters:t})}catch(e){console.error("Error cargando registros paginados:",e)}},le=async e=>{if(G.value){de(e);try{await $(G.value._id||G.value.id,{page:1,limit:10,filters:e})}catch(t){console.error("Error aplicando filtros:",t)}}},ce=async e=>{if(G.value)try{await $(G.value._id||G.value.id,{page:e,limit:10,filters:R.value.applied||{}})}catch(t){console.error("Error cambiando página:",t)}},ue=()=>{console.log("Toggle filtros ejecutado"),q.value=!q.value,console.log("Nuevo estado:",q.value)},de=e=>{K.value=e},pe=async()=>{K.value={},await le({})},ve=()=>{G.value&&G.value.columnas&&(o.valores={},G.value.columnas.forEach(e=>{const t="string"===typeof e?e:e.nombre,a="string"===typeof e?"texto":e.tipo;o.valores[t]="archivo"===a?[]:""}),console.log("Nueva fila inicializada:",o.valores))},me=()=>{a.nombre="",a.tipo="texto",a.seccionRelacionada="",a.campoMostrar="",a.opcionesSelect=""},ge=async()=>{if(!G.value)return void alert("No se encontró la sección actual");const e=a.nombre.trim().toLowerCase();if(!e)return void alert("El nombre del campo no puede estar vacío");const t=G.value.columnas.some(t=>{const a="string"===typeof t?t:t.nombre;return a===e});if(t)return void alert("El campo ya existe");const o={nombre:e,tipo:a.tipo};if("relacional"===a.tipo){if(!a.seccionRelacionada||!a.campoMostrar)return void alert("Para campos relacionales debes seleccionar una sección y un campo a mostrar");o.seccionRelacionada=a.seccionRelacionada,o.campoMostrar=a.campoMostrar}if("select"===a.tipo){if(!a.opcionesSelect||!a.opcionesSelect.trim())return void alert("Para campos select debes ingresar al menos una opción");o.opciones=a.opcionesSelect.split(",").map(e=>e.trim()).filter(e=>e)}"archivo"===a.tipo&&(o.configuracion={maxSize:10485760,allowedTypes:["*/*"],multiple:!0,autoOrganize:!0}),G.value.columnas.push(o),G.value.datos.forEach(t=>{t[e]="archivo"===a.tipo?[]:""}),me(),ve();try{await i["g"].update(G.value._id||G.value.id,G.value),await ie()}catch(r){alert("Error al agregar campo")}},fe=async()=>{if(!G.value)return;const e={};G.value.columnas.forEach(t=>{const a="string"===typeof t?t:t.nombre,r="string"===typeof t?"texto":t.tipo;e[a]="archivo"===r?o.valores[a]||[]:o.valores[a]||""});try{const t=await i["g"].createRegistro(G.value._id||G.value.id,{valores:e});G.value.datos&&Array.isArray(G.value.datos)?G.value.datos.push(t):G.value.datos=[t],await se(),ve()}catch(t){alert("Error al agregar fila")}},be=async()=>{if(!G.value)return;const e={};G.value.columnas.forEach(t=>{const a="string"===typeof t?t:t.nombre,r="string"===typeof t?"texto":t.tipo;e[a]="archivo"===r?o.valores[a]||[]:o.valores[a]||""}),console.log("Fila nueva a crear:",e);try{await i["g"].createRegistro(G.value._id||G.value.id,{valores:e});await se(),l.value=!1,ve()}catch(t){console.error("Error al agregar registro:",t),alert("Error al agregar registro")}},he=async e=>{if(!G.value)return;const t=T.value[e];if(t)try{await i["g"].deleteRegistro(G.value._id||G.value.id,t._id||t.id),await se()}catch(a){alert("Error al eliminar fila")}},ye=async e=>{if(!G.value)return;const t=G.value.columnas.splice(e,1)[0],a="string"===typeof t?t:t.nombre;G.value.datos.forEach(e=>{delete e[a]}),ve();try{await i["g"].update(G.value._id||G.value.id,G.value),await ie()}catch(o){alert("Error al eliminar campo")}},_e=async e=>{if(!G.value)return;const t=G.value.columnas[e];"string"===typeof t||t.nombre;if(!t.nombre||!t.nombre.trim())return void alert("El nombre del campo no puede estar vacío");const a=G.value.columnas.some((a,o)=>{if(o===e)return!1;const r="string"===typeof a?a:a.nombre;return r===t.nombre});if(a)alert("El nombre del campo ya existe");else if("relacional"!==t.tipo||t.seccionRelacionada&&t.campoMostrar)try{await i["g"].update(G.value._id||G.value.id,G.value),p.value="¡Campo actualizado correctamente!",setTimeout(()=>{p.value=""},2e3),await ie()}catch(o){alert("Error al guardar cambios de campo")}else alert("Para campos relacionales debes seleccionar una sección y un campo a mostrar")},Ce=()=>{if(!G.value)return;const e=JSON.stringify(G.value,null,2),t=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(t),o=document.createElement("a");o.href=a,o.download=G.value.nombre.toLowerCase().replace(/\s+/g,"-")+".json",o.click(),URL.revokeObjectURL(a)},we=()=>{r.value=!0},Ae=async()=>{if(G.value)try{for(const e of G.value.datos)await i["g"].deleteRegistro(G.value._id||G.value.id,e._id||e.id);r.value=!1,await ie()}catch(e){alert("Error al limpiar sección")}},Fe=async()=>{try{await i["g"].update(G.value._id||G.value.id,G.value),alert("Cambios guardados correctamente"),await ie()}catch(e){alert("Error al guardar sección")}},xe=()=>{t.value.forEach(e=>{e.columnas&&Array.isArray(e.columnas)&&(e.columnas=e.columnas.map(e=>"string"===typeof e?{nombre:e,tipo:"texto"}:e))})},Ee=(e,a)=>{if(!e||!a)return[];const o=t.value.find(t=>t.nombre===e);if(!o||!o.columnas||!o.datos)return[];const r=o.datos.map(e=>e[a]).filter(e=>e&&""!==e);return[...new Set(r)]},Se=e=>{if("string"===typeof e)return"Texto";switch(e.tipo){case"texto":return"Texto";case"textarea":return"Área de texto";case"numero":return"Número";case"fecha":return"Fecha";case"telefono":return"Teléfono";case"correo":return"Correo";case"enlace":return"Enlace";case"select":return"Select";case"relacional":return`Relacional (${e.seccionRelacionada})`;default:return"Texto"}},ke=e=>{if("string"===typeof e)return"text-primary";switch(e.tipo){case"texto":return"text-primary";case"textarea":return"text-info";case"numero":return"text-success";case"fecha":return"text-info";case"telefono":return"text-success";case"correo":return"text-info";case"enlace":return"text-warning";case"select":return"text-secondary";case"relacional":return"text-warning";default:return"text-primary"}},Oe=(e,t,a)=>{const o=e.nombre+"_"+a;D[o]=!0;const r=Ee(e.seccionRelacionada,e.campoMostrar);P[o]=r},je=(e,t)=>{const a=e.nombre+"_"+t;setTimeout(()=>{D[a]=!1},150)},Ne=(e,t,a,o)=>{const r=t.nombre+"_"+o,n=e.target.value.toLowerCase();a.valores[t.nombre]=e.target.value;const i=Ee(t.seccionRelacionada,t.campoMostrar);P[r]=i.filter(e=>e.toLowerCase().includes(n)),D[r]=!0},De=(e,t)=>{const a=t.nombre+"_nueva",r=e.target.value.toLowerCase();o.valores[t.nombre]=e.target.value;const n=Ee(t.seccionRelacionada,t.campoMostrar);P[a]=n.filter(e=>e.toLowerCase().includes(r)),D[a]=!0},Pe=(e,t,a,o)=>{const r=t+"_"+o;a.valores[t]=e,D[r]=!1},Ie=(e,t)=>{const a=t+"_nueva";o.valores[t]=e,D[a]=!1},Te=async e=>{if(G.value&&e._id)try{await i["g"].updateRegistro(G.value._id||G.value.id,e._id,{valores:e.valores})}catch(t){alert("Error al actualizar el registro")}},Me=async(e,t)=>{if(G.value&&e._id)try{const t=await i["g"].updateRegistro(G.value._id||G.value.id,e._id,{valores:e.valores});t&&t.valores?(Object.assign(e.valores,t.valores),e._original={...t.valores}):e._original={...e.valores},await se()}catch(a){alert("Error al guardar los cambios de la fila")}},Re=(e,t)=>{f.value++},ze=e=>{e.valores={...e.valores},e._editando=!0,f.value++};Object(n["watch"])(()=>e.sectionName,()=>{ve()}),Object(n["watch"])(l,e=>{e&&ve()}),Object(n["watch"])(G,async e=>{e&&(console.log("📋 Sección cambiada, cargando registros paginados..."),await se())}),Object(n["watch"])(()=>a.tipo,e=>{"relacional"!==e&&(a.seccionRelacionada="",a.campoMostrar="")}),Object(n["watch"])(()=>a.seccionRelacionada,()=>{a.campoMostrar=""});const $e=e=>{const t=G.value.columnas[e];t.opcionesString&&(t.opciones=t.opcionesString.split(",").map(e=>e.trim()).filter(e=>e))},Le=e=>{console.log("Archivo subido:",e)},Be=e=>{if(!e||!e.trim())return void alert("No hay número de teléfono para llamar");const t=e.replace(/[^\d+]/g,"");t?/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?window.location.href="tel:"+t:alert("Para llamar al número: "+t):alert("Número de teléfono inválido")},Ue=e=>{if(!e||!e.trim())return void alert("No hay dirección de correo para abrir");const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;t.test(e)?window.location.href="mailto:"+e:alert("Por favor ingrese un email válido")},Ve=e=>{if(!e||!e.trim())return void alert("No hay enlace para abrir");let t=e;e.startsWith("http://")||e.startsWith("https://")||(t="https://"+e);try{new URL(t),window.open(t,"_blank","noopener,noreferrer")}catch(a){alert("Por favor ingrese una URL válida")}},qe=e=>{u.value={...e},c.value=!0},Ke=()=>{c.value=!1;const e=T.value.findIndex(e=>e._id===u.value._id);-1!==e&&(I.value=u.value._id,setTimeout(()=>{const e=document.querySelector(`tr[data-id="${u.value._id}"]`);e&&e.scrollIntoView({behavior:"smooth",block:"center"})},100))},Ge=e=>{const t="string"===typeof e?"texto":e.tipo;return"field-value-"+t},He=e=>{if(!e)return"Sin fecha";try{const t=new Date(e);return t.toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",weekday:"long"})}catch(t){return e}};Object(n["watch"])(()=>G.value,()=>{G.value&&tt()});const Qe=async e=>{if(G.value)try{const t=await i["g"].createRegistro(G.value._id||G.value.id,{valores:e});G.value.datos&&Array.isArray(G.value.datos)?G.value.datos.push(t):G.value.datos=[t]}catch(t){alert("Error al agregar evento")}},Ye=async e=>{if(G.value)try{await i["g"].updateRegistro(G.value._id||G.value.id,e.id,{valores:e.data});const t=G.value.datos.findIndex(t=>t._id===e.id);-1!==t&&(G.value.datos[t].valores=e.data)}catch(t){alert("Error al actualizar evento")}},Ze=async e=>{if(G.value)try{await i["g"].deleteRegistro(G.value._id||G.value.id,e.id);const t=G.value.datos.findIndex(t=>t._id===e.id);-1!==t&&G.value.datos.splice(t,1)}catch(t){alert("Error al eliminar evento")}},We=()=>{console.log("🔄 Título cambiado:",_.value),console.log("🔄 Tipo:",typeof _.value),console.log("🔄 Longitud:",_.value?_.value.length:0)},Je=e=>{console.log("🎯 Seleccionando calendario:",e.title),k.value=e,C.value=e.enabled,_.value=e.title,h.value=e.dateField,y.value=e.titleField,F.value=e.defaultColor,E.value=e.displayFields||[],j.value=e.colorField||"",Object.assign(N,e.colorMapping||{});const t=new Date;rt(t.getFullYear(),t.getMonth()+1)},Xe=e=>{console.log("🎯 Seleccionando calendario desde modal:",e.title),k.value=e,C.value=e.enabled,_.value=e.title,h.value=e.dateField,y.value=e.titleField,F.value=e.defaultColor,E.value=e.displayFields||[],j.value=e.colorField||"",Object.assign(N,e.colorMapping||{})},et=()=>{console.log("➕ Creando nuevo calendario"),k.value=null,C.value=!0,_.value="",h.value="",y.value="",F.value="#007bff",E.value=[],j.value="",Object.keys(N).forEach(e=>delete N[e])},tt=()=>{if(!G.value||!G.value.columnas)return void console.log("No se puede inicializar calendario: sección no encontrada o sin columnas");console.log("Inicializando campos del calendario..."),console.log("Columnas disponibles:",G.value.columnas);const e=G.value.calendarConfig;if(e){if(console.log("📋 Configuración guardada encontrada:",e),C.value=e.enabled||!1,_.value=e.title||"",h.value=e.dateField||"",y.value=e.titleField||"",F.value=e.defaultColor||"#007bff",E.value=e.displayFields||[],j.value=e.colorField||"",Object.assign(N,e.colorMapping||{}),console.log("✅ Configuración cargada:",{enabled:C.value,title:_.value,dateField:h.value,titleField:y.value,displayFields:E.value,colorField:j.value,colorMapping:N}),C.value){const e=new Date;rt(e.getFullYear(),e.getMonth()+1)}}else{console.log("No hay configuración guardada, usando configuración por defecto");const e=G.value.columnas.find(e=>{const t="string"===typeof e?{nombre:e,tipo:"texto"}:e;return"fecha"===t.tipo});e?(h.value="string"===typeof e?e:e.nombre,console.log("Campo de fecha encontrado:",h.value)):console.log("No se encontró campo de fecha");const t=G.value.columnas.find(e=>{const t="string"===typeof e?{nombre:e,tipo:"texto"}:e;return"texto"===t.tipo});t?(y.value="string"===typeof t?t:t.nombre,console.log("Campo de título encontrado:",y.value)):console.log("No se encontró campo de título")}console.log("Estado final del calendario:"),console.log("- Habilitado:",C.value),console.log("- Campo fecha:",h.value),console.log("- Campo título:",y.value),console.log("- Campo color:",j.value)},at=()=>{if(C.value){const e=new Date;rt(e.getFullYear(),e.getMonth()+1)}else h.value="",y.value="",_.value="",E.value=[],F.value="#007bff",j.value="",Object.keys(N).forEach(e=>delete N[e])},ot=async()=>{if(G.value){if(C.value){console.log("🔍 Validando configuración del calendario:"),console.log("- Título (tipo):",typeof _.value),console.log("- Título (valor):",_.value),console.log("- Título (longitud):",_.value?_.value.length:0),console.log("- Campo fecha:",h.value),console.log("- Campo título:",y.value);const e=!_.value||""===_.value.trim(),t=!h.value,a=!y.value;if(console.log("- Título vacío:",e),console.log("- Fecha vacía:",t),console.log("- Campo título vacío:",a),e||t||a){let o=[];return e&&o.push("título del calendario"),t&&o.push("campo de fecha"),a&&o.push("campo de título"),void alert("Por favor completa: "+o.join(", "))}}try{console.log("💾 Guardando configuración del calendario..."),console.log("Configuración:",{seccionId:G.value._id||G.value.id,seccionNombre:G.value.nombre,title:_.value,enabled:C.value,dateField:h.value,titleField:y.value,defaultColor:F.value,displayFields:E.value}),G.value.calendarConfig={seccionId:G.value._id||G.value.id,seccionNombre:G.value.nombre,title:_.value,enabled:C.value,dateField:h.value,titleField:y.value,defaultColor:F.value,displayFields:E.value,colorField:j.value,colorMapping:{...N}};const e=await i["g"].saveCalendarConfig(G.value._id||G.value.id,{seccionId:G.value._id||G.value.id,seccionNombre:G.value.nombre,title:_.value,enabled:C.value,dateField:h.value,titleField:y.value,defaultColor:F.value,displayFields:E.value,colorField:j.value,colorMapping:{...N}});console.log("✅ Configuración guardada en el servidor:",e),w.value=!1;const t=C.value?"Calendario habilitado y configurado correctamente":"Calendario deshabilitado correctamente";alert(t),await ie(),setTimeout(()=>{const e=G.value&&G.value.calendarConfig;e?console.log("🔍 Verificación: Configuración actual en la sección:",e):console.warn("⚠️ Advertencia: No se encontró configuración después de guardar")},1e3)}catch(e){console.error("❌ Error al guardar configuración del calendario:",e),alert("Error al guardar la configuración: "+(e.message||"Error desconocido"))}}else alert("No se encontró la sección actual")},rt=async(e,t)=>{if(C.value&&G.value){A.value=!0;try{console.log("📅 Cargando datos del calendario..."),console.log("Sección:",G.value._id||G.value.id),console.log("Mes:",t),console.log("Año:",e),console.log("Título del calendario:",_.value);const a={month:t,year:e};_.value&&_.value.trim()&&(a.name=_.value),console.log("Parámetros de búsqueda:",a);const o=await i["g"].getCalendarData(G.value._id||G.value.id,a);console.log("✅ Respuesta del servidor:",o);const r=o&&o.data?o.data:[];O.value=r,console.log("📅 Datos del calendario procesados:",r),x.value=new Date(e,t-1,1)}catch(a){console.error("❌ Error cargando datos del calendario:",a)}finally{A.value=!1}}},nt=()=>{console.log("🧹 Limpiando estado del calendario..."),O.value=[],re.value=[],C.value=!1,h.value="",y.value="",_.value="",E.value=[],k.value=null,S.value=[],j.value="",Object.keys(N).forEach(e=>delete N[e]),b.value="table"},it=async()=>{if(G.value)try{console.log("📅 Cargando configuraciones de calendario..."),console.log("Sección:",G.value._id||G.value.id);const e=await i["g"].getCalendarConfigs(G.value._id||G.value.id),t=e&&e.data?e.data:e||[];S.value=t,console.log("✅ Configuraciones de calendario cargadas:",S.value),console.log("📊 Total de calendarios:",S.value.length);const a=S.value.filter(e=>e.enabled);if(a.length>0){const e=a[0];console.log("🎯 Cargando primer calendario habilitado:",e.title),C.value=e.enabled,_.value=e.title,h.value=e.dateField,y.value=e.titleField,F.value=e.defaultColor,E.value=e.displayFields||[],j.value=e.colorField||"",Object.assign(N,e.colorMapping||{});const t=new Date;rt(t.getFullYear(),t.getMonth()+1)}}catch(e){console.error("❌ Error cargando configuraciones de calendario:",e),S.value=[]}};return Object(n["onMounted"])(async()=>{console.log("🚀 Inicializando componente..."),await ie(),xe(),me(),console.log("✅ Componente inicializado")}),Object(n["watch"])(G,async e=>{e&&(nt(),await it())}),Object(n["watch"])(w,e=>{e&&tt()}),Object(n["watch"])(j,e=>{e&&oe.value&&oe.value.opciones.forEach(e=>{if(!N[e]){const t=["#007bff","#28a745","#ffc107","#dc3545","#6f42c1","#fd7e14","#20c997","#6c757d","#e83e8c","#17a2b8"],a=Object.keys(N).length%t.length;N[e]=t[a]}})}),{secciones:t,seccionActual:G,nuevoCampo:a,nuevaFila:o,showClearModal:r,showFieldsModal:s,otrasSecciones:H,calendarTitle:_,agregarCampo:ge,agregarFila:fe,eliminarFila:he,eliminarCampo:ye,guardarCambiosCampo:_e,exportarSeccion:Ce,limpiarSeccion:we,confirmarLimpiarSeccion:Ae,guardarSeccion:Fe,getOpcionesRelacionadas:Ee,limpiarFormularioCampo:me,puedeAgregarCampo:Y,camposSeccionRelacionada:Q,getTipoTexto:Se,getTipoClase:ke,mostrarOpciones:Oe,ocultarOpciones:je,filtrarOpciones:Ne,filtrarOpcionesNuevaFila:De,seleccionarOpcion:Pe,seleccionarOpcionNuevaFila:Ie,opcionesVisibles:D,opcionesFiltradas:P,campoAcordeonAbierto:d,mensajeExitoCampo:p,cargando:v,actualizarRegistro:Te,guardarFilaEditada:Me,revertirFila:Re,onFocusOut:ze,refreshKey:f,filaEditando:I,currentView:b,hasDateField:Z,hasCalendarConfigs:W,calendarEvents:re,dateFieldName:h,titleFieldName:y,availableFieldsForCalendar:ne,calendarEnabled:C,showCalendarSettings:w,calendarLoading:A,defaultEventColor:F,selectedDisplayFields:E,dateFields:ee,textFields:te,addCalendarEvent:Qe,updateCalendarEvent:Ye,deleteCalendarEvent:Ze,toggleCalendar:at,saveCalendarSettings:ot,loadCalendarData:rt,loadCalendarConfigs:it,clearCalendarState:nt,initializeCalendarFields:tt,onTitleChange:We,selectCalendar:Je,selectCalendarFromModal:Xe,createNewCalendar:et,calendarData:O,calendarConfigs:S,selectedCalendar:k,currentView:b,hasDateField:Z,calendarEvents:re,dateFieldName:h,titleFieldName:y,availableFieldsForCalendar:ne,calendarEnabled:C,showCalendarSettings:w,calendarLoading:A,defaultEventColor:F,selectedDisplayFields:E,dateFields:ee,textFields:te,addCalendarEvent:Qe,updateCalendarEvent:Ye,deleteCalendarEvent:Ze,toggleCalendar:at,saveCalendarSettings:ot,loadCalendarData:rt,actualizarOpcionesSelect:$e,registros:T,pagination:M,filters:R,loading:z,cargarRegistrosPaginados:se,aplicarFiltros:le,cambiarPagina:ce,getValorCampo:J,setValorCampo:X,filtrosAbiertos:q,filtrosActivos:K,toggleFiltros:ue,limpiarFiltros:pe,showAddModal:l,agregarFilaDesdeModal:be,onFilesUploaded:Le,showViewModal:c,registroSeleccionado:u,verRegistro:qe,editarDesdeModal:Ke,getFieldValueClass:Ge,formatearFecha:He,hacerLlamada:Be,abrirCorreo:Ue,abrirEnlace:Ve,colorFieldName:j,colorMapping:N,selectFields:ae,selectedColorField:oe}}},R=M,z=(a("c991"),Object(d["a"])(R,o,r,!1,null,"246f28e0",null));t["default"]=z.exports},c991:function(e,t,a){"use strict";a("6316")},ed18:function(e,t,a){"use strict";a("8a7f")},eefa:function(e,t,a){},f8ac:function(e,t,a){},fa4a:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var o=a("2b0e"),r=a("b9d1");const n=()=>{const e=Object(o["ref"])([]),t=Object(o["ref"])({}),a=Object(o["ref"])({}),n=Object(o["ref"])(!1),i=async(o,i={})=>{n.value=!0;try{const s={page:i.page||1,limit:i.limit||10,sortBy:i.sortBy||"createdAt",sortOrder:i.sortOrder||"desc"};i.filters&&Object.keys(i.filters).length>0&&(s.filters=i.filters),console.log("🔍 Enviando petición con parámetros:",{seccionId:o,queryParams:s});const l=await r["g"].getRegistrosPaginados(o,s);console.log("✅ Respuesta recibida:",l),e.value=l.data,t.value=l.pagination,a.value=l.filters}catch(s){console.error("❌ Error cargando registros:",s)}finally{n.value=!1}};return{registros:e,pagination:t,filters:a,loading:n,cargarRegistros:i}}}}]);